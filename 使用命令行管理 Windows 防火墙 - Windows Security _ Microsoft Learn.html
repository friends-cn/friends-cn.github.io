<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-dark" lang="zh-cn" dir="ltr" data-authenticated="false" data-auth-status-determined="true" data-target="docs" x-ms-format-detection="none"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta property="og:title" content="使用命令行管理 Windows 防火墙 - Windows Security">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line"><meta property="og:description" content="了解如何从命令行管理 Windows 防火墙。 本指南提供了如何使用 PowerShell 和 Netsh 管理 Windows 防火墙的示例。"><meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png">

	<meta property="og:image:alt" content="Microsoft Learn">

	<meta name="twitter:card" content="summary_large_image">

	<meta name="twitter:site" content="@MicrosoftLearn">

	<meta name="color-scheme" content="light dark"><meta name="adobe-target" content="true">
<meta name="author" content="paolomatarazzo">
<meta name="breadcrumb_path" content="/windows/resources/breadcrumb/toc.json">
<meta name="depot_name" content="TechNet.windows-security">
<meta name="description" content="了解如何从命令行管理 Windows 防火墙。 本指南提供了如何使用 PowerShell 和 Netsh 管理 Windows 防火墙的示例。">
<meta name="document_id" content="c5db536a-6143-8c09-b308-bd07fca3dec4">
<meta name="document_version_independent_id" content="c5db536a-6143-8c09-b308-bd07fca3dec4">
<meta name="feedback_help_link_type" content="">
<meta name="feedback_help_link_url" content="">
<meta name="feedback_product_url" content="https://support.microsoft.com/windows/send-feedback-to-microsoft-with-the-feedback-hub-app-f59187f8-8739-22d6-ba93-f66612949332">
<meta name="feedback_system" content="Standard">
<meta name="git_commit_id" content="9ac14a95eaa5f6bdde612967785bd364dc24de65">
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/windows-docs-pr/blob/9ac14a95eaa5f6bdde612967785bd364dc24de65/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line.md">
<meta name="loc_file_id" content="Github-176604163.live.TechNet.windows-security.operating-system-security/network-security/windows-firewall/configure-with-command-line.md">
<meta name="loc_source_id" content="Github-176604163#live">
<meta name="loc_version" content="2024-03-19T10:46:18.9995019Z">
<meta name="locale" content="zh-cn">
<meta name="manager" content="aaroncz">
<meta name="ms.author" content="paoloma">
<meta name="ms.collection" content="tier2">
<meta name="ms.contentlocale" content="zh-cn">
<meta name="ms.date" content="11/21/2023">
<meta name="ms.localizationpriority" content="medium">
<meta name="ms.reviewer" content="nganguly">
<meta name="ms.service" content="windows-client">
<meta name="ms.subservice" content="itpro-security">
<meta name="ms.topic" content="how-to">
<meta name="ms.translationtype" content="MT">
<meta name="ocv-translation-feedback" content="true">
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/windows-docs-pr/blob/live/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line.md">
<meta name="page_type" content="conceptual">
<meta name="recommendations" content="true">
<meta name="schema" content="Conceptual">
<meta name="site_name" content="Docs">
<meta name="toc_rel" content="../../../toc.json">
<meta name="uhfHeaderId" content="MSDocsHeader-Windows">
<meta name="updated_at" content="2024-03-22 05:58 AM">
<meta name="word_count" content="6631">
<meta name="persistent_id" content="fa29e292-796b-17ff-78df-9c516d9c1089">
	
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/bcbcbad5-4208-4783-8035-8481272c98b8" data-source="generated">
	
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/43b2e5aa-8a6d-4de2-a252-692232e5edc8" data-source="generated">
	<meta name="scope" content="Windows 10"><meta name="github_feedback_content_git_url" content="https://github.com/MicrosoftDocs/windows-itpro-docs/blob/public/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line.md"><link href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line" rel="canonical"><title>使用命令行管理 Windows 防火墙 - Windows Security | Microsoft Learn</title><link rel="stylesheet" href="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/site-ltr.css">

	<script id="msdocs-script">
	var msDocs = {environment: {
			supportLevel: 'production',
			accessLevel: 'online',
			reviewFeatures: false,
			systemContent: true,
			azurePortalHostname: 'portal.azure.com',
			legacyHosting: false,
			siteName: 'learn',
		},data: {
			timeOrigin: Date.now(),
			contentLocale: 'zh-cn',
			contentDir: 'ltr',
			userLocale: 'zh-cn',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {},
			hasBinaryRating: true,
			hasGithubIssues: false,
			feedbackHelpLinkType:'',
			feedbackHelpLinkUrl:'',
			standardFeedback: true,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'Standard',
			feedbackGitHubRepo: '',
			feedbackProductUrl: 'https://support.microsoft.com/windows/send-feedback-to-microsoft-with-the-feedback-hub-app-f59187f8-8739-22d6-ba93-f66612949332',extendBreadcrumb: false,isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasPrintButton: true,
			hasBookmark: true,
			hasShare: true,
			isPermissioned: false,
			isPrivateUnauthorized: false,hasRecommendations: true,contributors: [{ name: "paolomatarazzo", url: "https://github.com/paolomatarazzo" }],},
		functions:{}
	};
	</script><script src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/wcp-consent.js.download"></script>
	<script src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/ms.jsll-3.min.js.download"></script><script src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/deprecation.js.download"></script><link rel="preconnect" href="https://mscom.demdex.net/" crossorigin="">
		<link rel="dns-prefetch" href="https://target.microsoft.com/">
		<link rel="dns-prefetch" href="https://microsoftmscompoc.tt.omtrdc.net/">
		<link rel="preload" as="script" href="https://learn.microsoft.com/static/third-party/adobe-target/at-js/2.9.0/at.js" integrity="sha384-1/viVM50hgc33O2gOgkWz3EjiD/Fy/ld1dKYXJRUyjNYVEjSUGcSN+iPiQF7e4cu" crossorigin="anonymous" id="adobe-target-script" type="application/javascript"><script src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/index-docs.js.download"></script><style></style><style id="ms-consent-banner-main-styles">.w8hcgFksdo30C8w-bygqu{color:#000}.ydkKdaztSS0AeHWIeIHsQ a{color:#0067B8}.erL690_8JwUW-R4bJRcfl{background-color:#EBEBEB;border:none;color:#000}.erL690_8JwUW-R4bJRcfl:enabled:hover{color:#000;background-color:#DBDBDB;box-shadow:0px 4px 10px rgba(0,0,0,0.25);border:none}.erL690_8JwUW-R4bJRcfl:enabled:focus{background-color:#DBDBDB;box-shadow:0px 4px 10px rgba(0,0,0,0.25);border:2px solid #000}.erL690_8JwUW-R4bJRcfl:disabled{opacity:1;color:rgba(0,0,0,0.2);background-color:rgba(0,0,0,0.2);border:none}._1zNQOqxpBFSokeCLGi_hGr{border:none;background-color:#0067B8;color:#fff}._1zNQOqxpBFSokeCLGi_hGr:enabled:hover{color:#fff;background-color:#0067B8;box-shadow:0px 4px 10px rgba(0,0,0,0.25);border:none}._1zNQOqxpBFSokeCLGi_hGr:enabled:focus{background-color:#0067B8;box-shadow:0px 4px 10px rgba(0,0,0,0.25);border:2px solid #000}._1zNQOqxpBFSokeCLGi_hGr:disabled{opacity:1;color:rgba(0,0,0,0.2);background-color:rgba(0,120,215,0.2);border:none}._23tra1HsiiP6cT-Cka-ycB{position:relative;display:flex;z-index:9999;width:100%;background-color:#F2F2F2;justify-content:space-between;text-align:left}div[dir="rtl"]._23tra1HsiiP6cT-Cka-ycB{text-align:right}._1Upc2NjY8AlDn177YoVj0y{margin:0;padding-left:5%;padding-top:8px;padding-bottom:8px}div[dir="rtl"] ._1Upc2NjY8AlDn177YoVj0y{margin:0;padding:8px 5% 8px 0;float:none}._23tra1HsiiP6cT-Cka-ycB svg{fill:none;max-width:none;max-height:none}._1V_hlU-7jdtPiooHMu89BB{display:table-cell;padding:12px;width:24px;height:24px;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:normal;font-size:24px;line-height:0}.f6QKJD7fhSbnJLarTL-W-{display:table-cell;vertical-align:middle;padding:0;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:normal;font-size:13px;line-height:16px}.f6QKJD7fhSbnJLarTL-W- a{text-decoration:underline}._2j0fmugLb1FgYz6KPuB91w{display:inline-block;margin-left:5%;margin-right:5%;min-width:40%;min-width:calc((150px + 3 * 4px) * 2 + 150px);min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;align-self:center;position:relative}._1XuCi2WhiqeWRUVp3pnFG3{margin:4px;padding:5px;min-width:150px;min-height:36px;vertical-align:top;cursor:pointer;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:normal;font-size:15px;line-height:20px;text-align:center}._1XuCi2WhiqeWRUVp3pnFG3:focus{box-sizing:border-box}._1XuCi2WhiqeWRUVp3pnFG3:disabled{cursor:not-allowed}._2bvsb3ubApyZ0UGoQA9O9T{display:block;position:fixed;z-index:10000;top:0;left:0;width:100%;height:100%;background-color:rgba(255,255,255,0.6);overflow:auto;text-align:left}div[dir="rtl"]._2bvsb3ubApyZ0UGoQA9O9T{text-align:right}div[dir="rtl"] ._2bvsb3ubApyZ0UGoQA9O9T{left:auto;right:0}.AFsJE948muYyzCMktdzuk{position:relative;top:8%;margin-bottom:40px;margin-left:auto;margin-right:auto;box-sizing:border-box;width:640px;background-color:#fff;border:1px solid #0067B8}._3kWyBRbW_dgnMiEyx06Fu4{float:right;z-index:1;margin:2px;padding:12px;border:none;cursor:pointer;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:normal;font-size:13px;line-height:13px;display:flex;align-items:center;text-align:center;color:#666;background-color:#fff}div[dir="rtl"] ._3kWyBRbW_dgnMiEyx06Fu4{margin:2px;padding:12px;float:left}.uCYvKvHXrhjNgflv1VqdD{position:static;margin-top:36px;margin-left:36px;margin-right:36px}._17pX1m9O_W--iZbDt3Ta5r{margin-top:0;margin-bottom:12px;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:600;font-size:20px;line-height:24px;text-transform:none}._1kBkHQ1V1wu3kl-YcLgUr6{height:446px;overflow:auto}._20_nXDf6uFs9Q6wxRXG-I-{margin-top:0;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:normal;font-size:15px;line-height:20px}._20_nXDf6uFs9Q6wxRXG-I- a{text-decoration:underline}dl._2a0NH_GDQEQe5Ynfo7suVH{margin-top:36px;margin-bottom:0;padding:0;list-style:none;text-transform:none}dt._3j_LCPv7fyXv3A8FIXVwZ4{margin-top:20px;float:none;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:600;font-size:18px;line-height:24px;list-style:none}.k-vxTGFbdq1aOZB2HHpjh{margin:0;padding:0;border:none}._2Bucyy75c_ogoU1g-liB5R{margin:0;padding:0;border-bottom:none;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:600;font-size:18px;line-height:24px;text-transform:none}._63gwfzV8dclrsl2cfd90r{display:inline-block;margin-top:0;margin-bottom:13px;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:normal;font-size:15px;line-height:20px}._1l8wM_4mRYGz3Iu7l3BZR7{display:block}._2UE03QS02aZGkslegN_F-i{display:inline-block;position:relative;left:5px;margin-bottom:13px;margin-right:34px;padding:3px}div[dir="rtl"] ._2UE03QS02aZGkslegN_F-i{margin:0 0 13px 34px;padding:3px;float:none}div[dir="rtl"] ._2UE03QS02aZGkslegN_F-i{left:auto;right:5px}._23tra1HsiiP6cT-Cka-ycB *::before,._2bvsb3ubApyZ0UGoQA9O9T *::before,._23tra1HsiiP6cT-Cka-ycB *::after,._2bvsb3ubApyZ0UGoQA9O9T *::after{box-sizing:inherit}._1HSFn0HzGo6w4ADApV8-c4{outline:2px solid rgba(0,0,0,0.8)}input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2{display:inline-block;position:relative;margin-top:0;margin-left:0;margin-right:0;height:0;width:0;border-radius:0;cursor:pointer;outline:none;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2+label::before{display:block;position:absolute;top:5px;left:3px;height:19px;width:19px;content:"";border-radius:50%;border:1px solid #000;background-color:#fff}div[dir="rtl"] input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2+label::before{left:auto;right:3px}input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:not(:disabled)+label:hover::before{border:1px solid #0067B8}input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:not(:disabled)+label:hover::after{display:block;position:absolute;top:10px;left:8px;height:9px;width:9px;content:"";border-radius:50%;background-color:rgba(0,0,0,0.8)}div[dir="rtl"] input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:not(:disabled)+label:hover::after{left:auto;right:8px}input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:not(:disabled)+label:focus::before{border:1px solid #0067B8}input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:not(:disabled)+label:focus::after{display:block;position:absolute;top:10px;left:8px;height:9px;width:9px;content:"";border-radius:50%;background-color:#000}div[dir="rtl"] input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:not(:disabled)+label:focus::after{left:auto;right:8px}input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:checked+label::after{display:block;position:absolute;top:10px;left:8px;height:9px;width:9px;content:"";border-radius:50%;background-color:#000}div[dir="rtl"] input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:checked+label::after{left:auto;right:8px}input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:disabled+label{cursor:not-allowed}input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:disabled+label::before{border:1px solid rgba(0,0,0,0.2);background-color:rgba(0,0,0,0.2)}._3RJzeL3l9Rl_lAQEm6VwdX{display:block;position:static;float:right;margin-top:0;margin-bottom:0;margin-left:19px;margin-right:0;padding-top:0;padding-bottom:0;padding-left:8px;padding-right:0;width:80%;width:calc(100% - 19px);font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:normal;font-size:15px;line-height:20px;text-transform:none;cursor:pointer;box-sizing:border-box}div[dir="rtl"] ._3RJzeL3l9Rl_lAQEm6VwdX{margin:0 19px 0 0;padding:0 8px 0 0;float:left}.nohp3sIG12ZBhzcMnPala{margin-top:20px;margin-bottom:48px}._2uhaEsmeotZ3P-M0AXo2kF{padding:0;width:278px;height:36px;cursor:pointer;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:normal;font-size:15px;line-height:20px;text-align:center}._2uhaEsmeotZ3P-M0AXo2kF:focus{box-sizing:border-box}._2uhaEsmeotZ3P-M0AXo2kF:disabled{cursor:not-allowed}._3tOu1FJ59c_xz_PmI1lKV5{float:right;padding:0;width:278px;height:36px;cursor:pointer;font-family:Segoe UI, SegoeUI, Arial, sans-serif;font-style:normal;font-weight:normal;font-size:15px;line-height:20px;text-align:center}._3tOu1FJ59c_xz_PmI1lKV5:focus{box-sizing:border-box}._3tOu1FJ59c_xz_PmI1lKV5:disabled{cursor:not-allowed}div[dir="rtl"] ._3tOu1FJ59c_xz_PmI1lKV5{margin:0;padding:0;float:left}@media only screen and (max-width: 768px){._2j0fmugLb1FgYz6KPuB91w,._1Upc2NjY8AlDn177YoVj0y{padding-top:8px;padding-bottom:12px;padding-left:3.75%;padding-right:3.75%;margin:0;width:92.5%}._23tra1HsiiP6cT-Cka-ycB{display:block}._1XuCi2WhiqeWRUVp3pnFG3{margin-bottom:8px;margin-left:0;margin-right:0;width:100%}._2bvsb3ubApyZ0UGoQA9O9T{overflow:hidden}.AFsJE948muYyzCMktdzuk{top:1.8%;width:93.33%;height:96.4%;overflow:hidden}.uCYvKvHXrhjNgflv1VqdD{margin-top:24px;margin-left:24px;margin-right:24px;height:100%}._1kBkHQ1V1wu3kl-YcLgUr6{height:62%;height:calc(100% - 188px);min-height:50%}._2uhaEsmeotZ3P-M0AXo2kF{width:100%}._3tOu1FJ59c_xz_PmI1lKV5{margin-bottom:12px;margin-left:0;width:100%}div[dir="rtl"] ._3tOu1FJ59c_xz_PmI1lKV5{margin:0 0 12px 0;padding:0;float:none}}@media only screen and (max-width: 768px) and (orientation: landscape), only screen and (max-height: 260px), only screen and (max-width: 340px){.AFsJE948muYyzCMktdzuk{overflow:auto}}@media only screen and (max-height: 260px), only screen and (max-width: 340px){._1XuCi2WhiqeWRUVp3pnFG3{min-width:0}._3kWyBRbW_dgnMiEyx06Fu4{padding:3%}.uCYvKvHXrhjNgflv1VqdD{margin-top:3%;margin-left:3%;margin-right:3%}._17pX1m9O_W--iZbDt3Ta5r{margin-bottom:3%}._1kBkHQ1V1wu3kl-YcLgUr6{height:calc(79% - 64px)}.nohp3sIG12ZBhzcMnPala{margin-top:5%;margin-bottom:10%}._3tOu1FJ59c_xz_PmI1lKV5{margin-bottom:3%}div[dir="rtl"] ._3tOu1FJ59c_xz_PmI1lKV5{margin:0 0 3% 0;padding:0;float:none}}
</style><style type="text/css" id="ms-consent-banner-theme-styles">._23tra1HsiiP6cT-Cka-ycB {
            background-color: #242424 !important;
        }.w8hcgFksdo30C8w-bygqu {
            color: #E3E3E3 !important;
        }.ydkKdaztSS0AeHWIeIHsQ a {
            color: #4DB2FF !important;
        }._2bvsb3ubApyZ0UGoQA9O9T {
            background-color: rgba(23, 23, 23, 0.6) !important;
        }.AFsJE948muYyzCMktdzuk {
            background-color: #171717 !important;
            border: 1px solid #4DB2FF !important;
        }._3kWyBRbW_dgnMiEyx06Fu4 {
            color: #E3E3E3 !important;
            background-color: #171717 !important;
        }._1zNQOqxpBFSokeCLGi_hGr {
            border: 1px solid #4DB2FF !important;
            background-color: #4DB2FF !important;
            color: black !important;
        }._1zNQOqxpBFSokeCLGi_hGr:enabled:hover {
            color: black !important;
            background-color: #0091FF !important;
            box-shadow: none !important;
            border: 1px solid rgba(0, 0, 0, 0) !important;
        }._1zNQOqxpBFSokeCLGi_hGr:enabled:focus {
            background-color: #0091FF !important;
            box-shadow: none !important;
            border: 2px solid #4DB2FF !important;
        }._1zNQOqxpBFSokeCLGi_hGr:disabled {
            opacity: 0.5 !important;
            color: black !important;
            background-color: #4DB2FF !important;
            border: 1px solid rgba(255, 255, 255, 0) !important;
        }.erL690_8JwUW-R4bJRcfl {
            border: 1px solid #C7C7C7 !important;
            background-color: #171717 !important;
            color: #E3E3E3 !important;
        }.erL690_8JwUW-R4bJRcfl:enabled:hover {
            color: #E3E3E3 !important;
            background-color: #2E2E2E !important;
            box-shadow: none !important;
            border: 1px solid #C7C7C7 !important;
        }.erL690_8JwUW-R4bJRcfl:enabled:focus {
            background-color: #2E2E2E !important;
            box-shadow: none !important;
            border: 2px solid #C7C7C7 !important;
        }.erL690_8JwUW-R4bJRcfl:disabled {
            opacity: 0.5 !important;
            color: #E3E3E3 !important;
            background-color: #2E2E2E !important;
            border: 1px solid #242424 !important;
        }input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2 + label::before {
            border: 1px solid #E3E3E3 !important;
            background-color: #171717 !important;
        }._1HSFn0HzGo6w4ADApV8-c4 {
            outline: 2px solid rgba(227, 227, 227, 0.8) !important;
        }input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:checked + label::after {
            background-color: #E3E3E3 !important;
        }input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2 + label:hover::before {
            border: 1px solid #4DB2FF !important;
        }input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2 + label:hover::after {
            background-color: rgba(227, 227, 227, 0.8) !important;
        }input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2 + label:focus::before {
            border: 1px solid #4DB2FF !important;
        }input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2 + label:focus::after {
            background-color: #E3E3E3 !important;
        }input[type="radio"]._1dp8Vp5m3HwAqGx8qBmFV2:disabled + label::before {
            border: 1px solid rgba(227, 227, 227, 0.2) !important;
            background-color: rgba(227, 227, 227, 0.2) !important;
        }</style><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"name":"Learn","position":1,"@type":"ListItem","item":"https://learn.microsoft.com/zh-cn/"},{"name":"Windows","position":2,"@type":"ListItem","item":"https://learn.microsoft.com/zh-cn/windows/resources/"},{"name":"安全性","position":3,"@type":"ListItem","item":"https://learn.microsoft.com/zh-cn/windows/security/"}]}</script></head>

<body lang="zh-cn" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">跳转至主内容</a>

		<div id="cookie-consent-holder" data-test-id="cookie-consent-container"></div><div id="banner-holder" class="has-default-focus has-overflow-hidden display-none-visual-diff theme-light"><!----><!----></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;" hidden="">
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">此浏览器不再受支持。</p>
				<p style="font-size: 16px; margin-top: 16px;">请升级到 Microsoft Edge 以使用最新的功能、安全更新和技术支持。</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881" style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">下载 Microsoft Edge</a>
					<a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge" style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">有关 Internet Explorer 和 Microsoft Edge 的详细信息</a>
				</div>
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
			<div id="ms--mobile-nav" class="site-header display-none-tablet padding-inline-none gap-none" data-bi-name="mobile-header" data-test-id="mobile-header"><!---->
		<div id="ms--site-header-hamburger" data-test-id="site-header-hamburger">
			<button type="button" class="button button-clear inner-focus" data-test-id="mobile-nav-open-button" data-bi-name="mobile-nav-open-button" title="全球导航" aria-label="全球导航">
				<span class="icon" aria-hidden="true">
					<span class="docon docon-menu"></span>
				</span>
			</button>
		</div>

		<!-- Brand -->
		
		<a class="site-header-brand" itemprop="url" href="https://learn.microsoft.com/zh-cn/" data-bi-name="site-header-brand-learn-mobile" data-test-id="site-header-brand-mobile">
			<span><!---->Learn<!----></span>
		</a>
	

		<!-- MS logo -->
		
				<a href="https://www.microsoft.com/" aria-label="Microsoft" itemprop="url" data-bi-name="site-header-microsoft-logo-mobile" data-test-id="site-header-microsoft-logo-mobile" class="site-header-logo site-header-logo-centered">
					
		<svg aria-hidden="true" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg" itemprop="logo" itemscope="itemscope">
			<path d="M11.5216 0.5H0V11.9067H11.5216V0.5Z" fill="#f25022"></path>
			<path d="M24.2418 0.5H12.7202V11.9067H24.2418V0.5Z" fill="#7fba00"></path>
			<path d="M11.5216 13.0933H0V24.5H11.5216V13.0933Z" fill="#00a4ef"></path>
			<path d="M24.2418 13.0933H12.7202V24.5H24.2418V13.0933Z" fill="#ffb900"></path>
		</svg>
	
				</a>
		  

		<!-- Search -->
		
		<search-expander data-test-id="site-header-search-mobile" class="display-flex flex-grow-1 justify-content-flex-end">
			<div hidden="" id="ms--site-header-search-mobile" class="display-flex align-items-center gap-xxs width-full padding-left-xxs">
				
		<form class="flex-grow-1" method="GET" role="search" id="ms--site-header-search-form-mobile" data-bi-name="site-header-search-form-mobile" name="site-header-search-form-mobile" aria-label="搜索" action="https://learn.microsoft.com/zh-cn/search/">
			<div class="autocomplete display-block" data-bi-name="autocomplete"><!---->
			<div class="field-body control ">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="site-header-search-autocomplete-input-mobile" data-test-id="site-header-search-autocomplete-input-mobile" class="autocomplete-input input 
						
						width-full" type="search" name="terms" aria-expanded="false" aria-owns="ax-1-listbox" aria-controls="ax-1-listbox" aria-activedescendant="" aria-label="搜索" aria-describedby="ms--site-header-search-autocomplete-input-mobile-description" placeholder="搜索" data-bi-name="site-header-search-autocomplete-input-mobile" pattern=".*">

				

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>

				<span hidden="" id="ms--site-header-search-autocomplete-input-mobile-description">
					建议将在你键入时进行筛选
				</span>
			</div>

			<ul role="listbox" id="ax-1-listbox" data-test-id="site-header-search-autocomplete-input-mobile-listbox" class="autocomplete-suggestions is-vertically-scrollable padding-xxs " aria-label="建议" hidden="">
				
				
			</ul>
		<!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="">
			
			
		</form>
	
				<button data-search-expander-trigger-close="" type="button" class="button button-clear inner-focus" aria-controls="ms--site-header-search-mobile" aria-label="关闭搜索" data-bi-name="site-header-search-close-mobile" data-test-id="site-header-search-close-mobile">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-navigate-close"></span>
					</span>
				</button>
			</div>
			<button data-search-expander-trigger-open="" type="button" class="button button-clear inner-focus" aria-controls="ms--site-header-search-mobile" aria-label="打开搜素" data-bi-name="site-header-search-open-mobile" data-test-id="site-header-search-open-mobile">
				<span class="icon" aria-hidden="true">
					<span class="docon docon-search"></span>
				</span>
			</button>
		</search-expander>
	

		<!-- User avatar/Sign in -->
		<!---->
		<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#" data-bi-name="site-header-sign-in-mobile" data-test-id="site-header-sign-in-mobile" class="link-button font-size-sm flex-shrink-0 docs-sign-in auth-status-determined not-authenticated margin-right-xs margin-left-xxs">
			登录
		</a>
	 
		<details data-bi-name="site-header-user-mobile" class="popover popover-right auth-status-determined authenticated margin-right-xs margin-left-xxs">
			<summary data-bi-name="site-header-user-avatar" aria-label="你的帐户" data-test-id="site-header-user-mobile">
				<div class="persona persona-sm">
					<figure class="persona-avatar">
						<img alt="" data-profile-property="avatarThumbnailUrl">
					</figure>
				</div>
			</summary>
			<div class="popover-content width-auto" data-bi-name="site-header-user-menu">
				<div class="persona persona-sm">
					<figure class="persona-avatar">
						<img alt="" data-profile-property="avatarUrl" aria-labelledby="ms--user-display-name-mobile">
					</figure>
					<div class="persona-details">
						<p class="persona-name" data-profile-property="displayName" id="ms--user-display-name-mobile"></p>
						<p data-profile-property="upn"></p>
					</div>
				</div>
				<ul class="padding-block-xs">
					<li class="padding-bottom-xs">
						<a data-profile-property="profileUrl" class="font-size-sm" data-bi-name="site-header-user-profile" href="https://learn.microsoft.com/zh-cn/users/me/activity/">
							配置文件
						</a>
					</li>
					<li>
						<a data-profile-property="settingsUrl" class="font-size-sm" data-bi-name="site-header-user-settings" href="https://learn.microsoft.com/zh-cn/users/me/settings/">
							设置
						</a>
					</li>
				</ul>
				<div class="border-top padding-top-xs">
					<a class="docs-sign-out font-size-sm" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#" data-bi-name="site-header-sign-out-mobile" data-test-id="site-header-user-sign-out-mobile">
						注销
					</a>
				</div>
			</div>
		</details>
	<!---->
	<!----></div>
			<div id="ms--primary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L1-header" data-test-id="primary-header"><!---->
		<!-- MS logo -->
		
				<a href="https://www.microsoft.com/" aria-label="Microsoft" itemprop="url" data-bi-name="site-header-microsoft-logo" data-test-id="site-header-microsoft-logo" class="site-header-logo ">
					
		<svg aria-hidden="true" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg" itemprop="logo" itemscope="itemscope">
			<path d="M11.5216 0.5H0V11.9067H11.5216V0.5Z" fill="#f25022"></path>
			<path d="M24.2418 0.5H12.7202V11.9067H24.2418V0.5Z" fill="#7fba00"></path>
			<path d="M11.5216 13.0933H0V24.5H11.5216V13.0933Z" fill="#00a4ef"></path>
			<path d="M24.2418 13.0933H12.7202V24.5H24.2418V13.0933Z" fill="#ffb900"></path>
		</svg>
	
				</a>
		  

		<!-- Divider -->
		<div class="site-header-divider"></div>

		<!-- Brand -->
		
		<a class="site-header-brand" itemprop="url" href="https://learn.microsoft.com/zh-cn/" data-bi-name="site-header-brand-learn" data-test-id="site-header-brand">
			<span><!---->Learn<!----></span>
		</a>
	

		<div id="ms--search-expander-wrapper" class="display-flex justify-content-space-between flex-grow-1 align-items-center overflow-x-hidden height-full">
			<!-- Main Nav -->
			
		<overflow-menu class="align-self-stretch" style="display: block; overflow: hidden; width: 100%;">
			<nav class="site-header-nav" data-bi-name="primary-nav" data-overflow-menu-container="" aria-label="全球" style="visibility: visible; overflow: hidden;">
				<button type="button" data-overflow-menu-prev-button="" data-bi-name="site-header-btn-prev" class="button button-clear button-sm inner-focus" hidden="" aria-label="上一篇">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-chevron-left-light"></span>
					</span>
				</button>

				
		<ul class="display-flex gap-xxs-desktop">
			<!---->
			<li aria-setsize="4" aria-posinset="1">
				<panel-controller data-bi-name="site-header-btn-1-discover">
					<button type="button" aria-expanded="false" class="site-header-button" data-overflow-menu-item="" aria-controls="ms--panel-1" data-test-id="site-header-panel-controller-1" style="white-space: nowrap;">
						<span><!---->发现<!----></span>
						<span class="icon expanded-indicator" aria-hidden="true">
							<span class="docon docon-chevron-down-light"></span>
						</span>
					</button>
					<div class="site-header-panel" hidden="" id="ms--panel-1" data-bi-name="panel-1-discover" data-test-id="site-header-panel-1">
						
		<div class="site-header-panel-content">
			<ul class="site-header-panel-cards">
				<!---->
				<li>
					<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="panel-card-1-documentation">
						<div class="card-content">
							<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/docs/">
								文档
							</a>
							<p class="card-content-description line-clamp-2"><!---->有关 Microsoft 开发人员工具和技术的深度文章<!----></p>
						</div>
					</article>
				</li>
			<!---->
				<li>
					<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="panel-card-2-training">
						<div class="card-content">
							<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/training/">
								培训
							</a>
							<p class="card-content-description line-clamp-2"><!---->个性化学习路径和课程<!----></p>
						</div>
					</article>
				</li>
			<!---->
				<li>
					<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="panel-card-3-credentials">
						<div class="card-content">
							<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/credentials/">
								凭证
							</a>
							<p class="card-content-description line-clamp-2"><!---->全球认可、行业公认的凭证<!----></p>
						</div>
					</article>
				</li>
			<!---->
				<li>
					<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="panel-card-4-qna">
						<div class="card-content">
							<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/answers/">
								问答
							</a>
							<p class="card-content-description line-clamp-2"><!---->经 Microsoft 审核的技术问题和解答<!----></p>
						</div>
					</article>
				</li>
			<!---->
				<li>
					<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="panel-card-5-code-samples">
						<div class="card-content">
							<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/samples/">
								代码示例
							</a>
							<p class="card-content-description line-clamp-2"><!---->Microsoft 开发人员工具和技术的代码示例库<!----></p>
						</div>
					</article>
				</li>
			<!---->
				<li>
					<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="panel-card-6-assessments">
						<div class="card-content">
							<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/assessments/">
								评估
							</a>
							<p class="card-content-description line-clamp-2"><!---->交互式特选指南和建议<!----></p>
						</div>
					</article>
				</li>
			<!---->
				<li>
					<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="panel-card-7-shows">
						<div class="card-content">
							<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/shows/">
								节目
							</a>
							<p class="card-content-description line-clamp-2"><!---->来自 Microsoft 专家的数千小时原创节目<!----></p>
						</div>
					</article>
				</li>
			<!---->
			</ul>
			
		</div>
		
			<section class="site-header-panel-featured-content"><!----><!---->
				<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="featured-card-1-featured-assessment">
					<div class="card-content">
						<p class="card-supertitle"><!---->特别推荐的评估<!----></p>
						<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/assessments/1c032171-8ca0-4032-8962-a38a5cc424a8/">
							这是你的 AI 学习之旅
						</a>
						<p class="card-content-description line-clamp-2"><!---->无论你处于 AI 学习的哪个阶段，Microsoft Learn 都能满足你的需求，帮助你加深技能。<!----></p>
					</div>
				</article>
			<!----><!----></section>
		
	
					</div>
				</panel-controller>
			</li>
		<!---->
			<li aria-setsize="4" aria-posinset="2">
				<panel-controller data-bi-name="site-header-btn-2-product-documentation">
					<button type="button" aria-expanded="false" class="site-header-button" data-overflow-menu-item="" aria-controls="ms--panel-2" data-test-id="site-header-panel-controller-2" style="white-space: nowrap;">
						<span><!---->产品文档<!----></span>
						<span class="icon expanded-indicator" aria-hidden="true">
							<span class="docon docon-chevron-down-light"></span>
						</span>
					</button>
					<div class="site-header-panel" hidden="" id="ms--panel-2" data-bi-name="panel-2-product-documentation" data-test-id="site-header-panel-2">
						
		<div class="site-header-panel-content">
			<ul class="site-header-panel-links">
				<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/aspnet/" data-bi-name="panel-link-1-asp-dotnet">
						ASP.NET
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/azure/" data-bi-name="panel-link-2-azure">
						Azure
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/dynamics365/" data-bi-name="panel-link-3-dynamics365">
						Dynamics 365
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/microsoft-365/" data-bi-name="panel-link-4-microsoft-365">
						Microsoft 365
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/microsoft-edge/" data-bi-name="panel-link-5-microsoft-edge">
						Microsoft Edge
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/entra/" data-bi-name="panel-link-6-microsoft-entra">
						Microsoft Entra
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/graph/" data-bi-name="panel-link-7-microsoft-graph">
						Microsoft Graph
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/mem/" data-bi-name="panel-link-8-microsoft-intune">
						Microsoft Intune
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/purview/" data-bi-name="panel-link-9-microsoft-purview">
						Microsoft Purview
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/microsoftteams/" data-bi-name="panel-link-10-microsoft-teams">
						Microsoft Teams
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/dotnet/" data-bi-name="panel-link-11-dotnet">
						.NET
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/power-apps/" data-bi-name="panel-link-12-power-apps">
						Power Apps
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/power-automate/" data-bi-name="panel-link-13-power-automate">
						Power Automate
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/power-bi/" data-bi-name="panel-link-14-power-bi">
						Power BI
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/power-platform/" data-bi-name="panel-link-15-power-platform">
						Power Platform
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/powershell/" data-bi-name="panel-link-16-powershell">
						PowerShell
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/sql/" data-bi-name="panel-link-17-sql">
						SQL
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/sysinternals/" data-bi-name="panel-link-18-sysinternals">
						Sysinternals
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/visualstudio/" data-bi-name="panel-link-19-visual-studio">
						Visual Studio
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/windows/" data-bi-name="panel-link-20-windows">
						Windows
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/windows-server/" data-bi-name="panel-link-21-windows-server">
						Windows Server
					</a>
				</li>
			<!---->
			</ul>
			
			<a class="button button-clear button-sm color-hyperlink justify-content-flex-start border-none background-color-transparent margin-top-sm" href="https://learn.microsoft.com/zh-cn/docs/" data-bi-name="panel-cta-view-all-products">
				查看所有产品
			</a>
		
		</div>
		
			<section class="site-header-panel-featured-content"><!----><!---->
				<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="featured-card-1-featured-assessment">
					<div class="card-content">
						<p class="card-supertitle"><!---->特别推荐的评估<!----></p>
						<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/assessments/1c032171-8ca0-4032-8962-a38a5cc424a8/">
							这是你的 AI 学习之旅
						</a>
						<p class="card-content-description line-clamp-2"><!---->无论你处于 AI 学习的哪个阶段，Microsoft Learn 都能满足你的需求，帮助你加深技能。<!----></p>
					</div>
				</article>
			<!----><!----></section>
		
	
					</div>
				</panel-controller>
			</li>
		<!---->
			<li aria-setsize="4" aria-posinset="3">
				<panel-controller data-bi-name="site-header-btn-3-dev-languages">
					<button type="button" aria-expanded="false" class="site-header-button" data-overflow-menu-item="" aria-controls="ms--panel-3" data-test-id="site-header-panel-controller-3" style="white-space: nowrap;">
						<span><!---->开发语言<!----></span>
						<span class="icon expanded-indicator" aria-hidden="true">
							<span class="docon docon-chevron-down-light"></span>
						</span>
					</button>
					<div class="site-header-panel" hidden="" id="ms--panel-3" data-bi-name="panel-3-dev-languages" data-test-id="site-header-panel-3">
						
		<div class="site-header-panel-content">
			<ul class="site-header-panel-links">
				<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/cpp/" data-bi-name="panel-link-1-cpp">
						C++
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/dax/" data-bi-name="panel-link-2-dax">
						DAX
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/java/" data-bi-name="panel-link-3-java">
						Java
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/odata/" data-bi-name="panel-link-4-odata">
						OData
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/openapi/" data-bi-name="panel-link-5-open-api">
						OpenAPI
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/powerquery-m/" data-bi-name="panel-link-6-power-query-m">
						Power Query M
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/office/vba/" data-bi-name="panel-link-7-vba">
						VBA
					</a>
				</li>
			<!---->
			</ul>
			
		</div>
		
			<section class="site-header-panel-featured-content"><!----><!---->
				<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="featured-card-1-featured-assessment">
					<div class="card-content">
						<p class="card-supertitle"><!---->特别推荐的评估<!----></p>
						<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/assessments/1c032171-8ca0-4032-8962-a38a5cc424a8/">
							这是你的 AI 学习之旅
						</a>
						<p class="card-content-description line-clamp-2"><!---->无论你处于 AI 学习的哪个阶段，Microsoft Learn 都能满足你的需求，帮助你加深技能。<!----></p>
					</div>
				</article>
			<!----><!----></section>
		
	
					</div>
				</panel-controller>
			</li>
		<!---->
			<li aria-setsize="4" aria-posinset="4">
				<panel-controller data-bi-name="site-header-btn-4-topics">
					<button type="button" aria-expanded="false" class="site-header-button" data-overflow-menu-item="" aria-controls="ms--panel-4" data-test-id="site-header-panel-controller-4" style="white-space: nowrap;">
						<span><!---->主题<!----></span>
						<span class="icon expanded-indicator" aria-hidden="true">
							<span class="docon docon-chevron-down-light"></span>
						</span>
					</button>
					<div class="site-header-panel" hidden="" id="ms--panel-4" data-bi-name="panel-4-topics" data-test-id="site-header-panel-4">
						
		<div class="site-header-panel-content">
			<ul class="site-header-panel-links">
				<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/ai/" data-bi-name="panel-link-1-ai">
						人工智能
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/compliance/" data-bi-name="panel-link-2-compliance">
						合规性
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/devops/" data-bi-name="panel-link-3-devops">
						DevOps
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/platform-engineering/" data-bi-name="panel-link-4-platform-engineering">
						平台工程
					</a>
				</li>
			<!---->
				<li>
					<a class="button button-clear button-sm button-block font-weight-normal justify-content-flex-start inner-focus border-none background-color-body-accent-onhover" href="https://learn.microsoft.com/zh-cn/security/" data-bi-name="panel-link-5-security">
						安全性
					</a>
				</li>
			<!---->
			</ul>
			
		</div>
		
			<section class="site-header-panel-featured-content"><!----><!---->
				<article class="card position-relative background-color-body-accent-onhover background-color-body-medium box-shadow-none" data-bi-name="featured-card-1-featured-assessment">
					<div class="card-content">
						<p class="card-supertitle"><!---->特别推荐的评估<!----></p>
						<a class="card-title color-text background-color-transparent stretched-link" href="https://learn.microsoft.com/zh-cn/assessments/1c032171-8ca0-4032-8962-a38a5cc424a8/">
							这是你的 AI 学习之旅
						</a>
						<p class="card-content-description line-clamp-2"><!---->无论你处于 AI 学习的哪个阶段，Microsoft Learn 都能满足你的需求，帮助你加深技能。<!----></p>
					</div>
				</article>
			<!----><!----></section>
		
	
					</div>
				</panel-controller>
			</li>
		<!---->
		</ul>
	

				<button type="button" data-overflow-menu-next-button="" data-bi-name="site-header-btn-next" class="button button-clear button-sm inner-focus margin-left-auto" hidden="" aria-label="下一步">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-chevron-right-light"></span>
					</span>
				</button>
			</nav>
		</overflow-menu>
	

			<!-- Search -->
			
		<search-expander data-test-id="site-header-search" class="flex-grow-1 margin-left-xxs">
			<div hidden="" id="ms--site-header-search" class="display-flex align-items-center gap-xxs ">
				
		<form class="flex-grow-1" method="GET" role="search" id="ms--site-header-search-form" data-bi-name="site-header-search-form" name="site-header-search-form" aria-label="搜索" action="https://learn.microsoft.com/zh-cn/search/">
			<div class="autocomplete display-block" data-bi-name="autocomplete"><!---->
			<div class="field-body control ">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="site-header-search-autocomplete-input" data-test-id="site-header-search-autocomplete-input" class="autocomplete-input input input-sm
						
						width-full" type="search" name="terms" aria-expanded="false" aria-owns="ax-0-listbox" aria-controls="ax-0-listbox" aria-activedescendant="" aria-label="搜索" aria-describedby="ms--site-header-search-autocomplete-input-description" placeholder="搜索" data-bi-name="site-header-search-autocomplete-input" pattern=".*">

				

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>

				<span hidden="" id="ms--site-header-search-autocomplete-input-description">
					建议将在你键入时进行筛选
				</span>
			</div>

			<ul role="listbox" id="ax-0-listbox" data-test-id="site-header-search-autocomplete-input-listbox" class="autocomplete-suggestions is-vertically-scrollable padding-xxs " aria-label="建议" hidden="">
				
				
			</ul>
		<!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="">
			
			
		</form>
	
				<button data-search-expander-trigger-close="" type="button" class="button button-clear inner-focus" aria-controls="ms--site-header-search" aria-label="关闭搜索" data-bi-name="site-header-search-close" data-test-id="site-header-search-close">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-navigate-close"></span>
					</span>
				</button>
			</div>
			<button data-search-expander-trigger-open="" type="button" class="button button-clear inner-focus" aria-controls="ms--site-header-search" aria-label="打开搜素" data-bi-name="site-header-search-open" data-test-id="site-header-search-open">
				<span class="icon" aria-hidden="true">
					<span class="docon docon-search"></span>
				</span>
			</button>
		</search-expander>
	
		</div>

		<!-- User avatar/Sign in -->
		<!---->
		<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#" data-bi-name="site-header-sign-in" data-test-id="site-header-sign-in" class="link-button font-size-sm flex-shrink-0 docs-sign-in auth-status-determined not-authenticated ">
			登录
		</a>
	 
		<details data-bi-name="site-header-user" class="popover popover-right auth-status-determined authenticated ">
			<summary data-bi-name="site-header-user-avatar" aria-label="你的帐户" data-test-id="site-header-user">
				<div class="persona ">
					<figure class="persona-avatar">
						<img alt="" data-profile-property="avatarThumbnailUrl">
					</figure>
				</div>
			</summary>
			<div class="popover-content width-auto" data-bi-name="site-header-user-menu">
				<div class="persona ">
					<figure class="persona-avatar">
						<img alt="" data-profile-property="avatarUrl" aria-labelledby="ms--user-display-name">
					</figure>
					<div class="persona-details">
						<p class="persona-name" data-profile-property="displayName" id="ms--user-display-name"></p>
						<p data-profile-property="upn"></p>
					</div>
				</div>
				<ul class="padding-block-xs">
					<li class="padding-bottom-xs">
						<a data-profile-property="profileUrl" class="font-size-sm" data-bi-name="site-header-user-profile" href="https://learn.microsoft.com/zh-cn/users/me/activity/">
							配置文件
						</a>
					</li>
					<li>
						<a data-profile-property="settingsUrl" class="font-size-sm" data-bi-name="site-header-user-settings" href="https://learn.microsoft.com/zh-cn/users/me/settings/">
							设置
						</a>
					</li>
				</ul>
				<div class="border-top padding-top-xs">
					<a class="docs-sign-out font-size-sm" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#" data-bi-name="site-header-sign-out" data-test-id="site-header-user-sign-out">
						注销
					</a>
				</div>
			</div>
		</details>
	<!---->
	<!----></div>
			<div id="ms--secondary-nav" class="display-none display-flex-tablet" data-bi-name="L2-header" data-test-id="secondary-header"><!----><div class="site-header width-full"><!----> 
		<a class="site-header-brand font-size-h6 padding-inline-none margin-right-xxs" itemprop="url" href="https://learn.microsoft.com/zh-cn/windows/" data-bi-name="secondary-nav-link-category-windows">
			<span>
				Windows
				
			</span>
		</a>
	 
		
		<nav class="site-header-nav width-auto" data-bi-name="secondary-nav" aria-label="站点">
			<ul class="display-flex">
				<!---->
				<li>
					<a data-test-id="header-link-发布运行状况" class="has-external-link-indicator site-header-button " href="https://learn.microsoft.com/zh-cn/windows/release-health/" data-bi-name="secondary-nav-link-1-release-health">
						<span><!---->发布运行状况<!----></span>
					</a>
				</li>
		  <!---->
		<li class="dropdown">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  site-header-button-icon-chevron" aria-controls="bx-326" data-bi-name="secondary-nav-btn-2-windows-client" value="undefined">
				<span><!---->Windows 客户端<!----></span>
				<span aria-hidden="true" class="icon expanded-indicator ">
					<span class="docon docon-chevron-down-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-326" aria-label="Windows 客户端" data-bi-name="secondary-nav-menu-2-windows-client">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/resources/" data-bi-name="secondary-nav-link-1-windows-client-for-it-pros">
						<span><!---->面向 IT 专业人士的 Windows 客户端<!----></span>
					</a>
				</li>
		  <!---->
		<li class="dropdown">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  width-full justify-content-space-between padding-inline-xs padding-block-xxs" aria-controls="bx-327" data-bi-name="secondary-nav-btn-2-deployment" value="undefined">
				<span><!---->部署<!----></span>
				<span aria-hidden="true" class="icon  margin-left-xs">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-327" aria-label="部署" data-bi-name="secondary-nav-menu-2-deployment">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/mem/autopilot/" data-bi-name="secondary-nav-link-1-windows-autopilot">
						<span><!---->Windows Autopilot<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/deployment/windows-autopatch/" data-bi-name="secondary-nav-link-2-windows-autopatch">
						<span><!---->Windows 自动修补<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/deployment/" data-bi-name="secondary-nav-link-3-deploy-hub">
						<span><!---->部署中心<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/security/" data-bi-name="secondary-nav-link-3-security">
						<span><!---->安全性<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/privacy/" data-bi-name="secondary-nav-link-4-privacy">
						<span><!---->隐私<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/client-management/" data-bi-name="secondary-nav-link-5-client-management">
						<span><!---->客户端管理<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/configuration/" data-bi-name="secondary-nav-link-6-configuration">
						<span><!---->配置<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/education/windows/" data-bi-name="secondary-nav-link-7-windows-for-education">
						<span><!---->Windows 教育版<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/troubleshoot/windows-client/" data-bi-name="secondary-nav-link-8-troubleshooting">
						<span><!---->疑难解答<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
		<li class="dropdown">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  site-header-button-icon-chevron" aria-controls="bx-328" data-bi-name="secondary-nav-btn-3-application-developers" value="undefined">
				<span><!---->应用程序开发人员<!----></span>
				<span aria-hidden="true" class="icon expanded-indicator ">
					<span class="docon docon-chevron-down-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-328" aria-label="应用程序开发人员" data-bi-name="secondary-nav-menu-3-application-developers">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/apps/" data-bi-name="secondary-nav-link-1-windows-app-development-documentation">
						<span><!---->Windows 应用开发文档<!----></span>
					</a>
				</li>
		  <!---->
		<li class="dropdown">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  width-full justify-content-space-between padding-inline-xs padding-block-xxs" aria-controls="bx-329" data-bi-name="secondary-nav-btn-2-app-developer-tools" value="undefined">
				<span><!---->Web 开发人员工具<!----></span>
				<span aria-hidden="true" class="icon  margin-left-xs">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-329" aria-label="Web 开发人员工具" data-bi-name="secondary-nav-menu-2-app-developer-tools">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/apps/windows-app-sdk/" data-bi-name="secondary-nav-link-1-windows-app-sdk">
						<span><!---->Windows 应用 SDK<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/apps/winui/" data-bi-name="secondary-nav-link-2-windows-ui-library">
						<span><!---->Windows UI 库<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/msix/" data-bi-name="secondary-nav-link-3-msix">
						<span><!---->MSIX<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/terminal/" data-bi-name="secondary-nav-link-4-windows-terminal">
						<span><!---->Windows 终端<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/android/wsa/" data-bi-name="secondary-nav-link-5-windows-subsystem-for-android">
						<span><!---->适用于 Android 的 Windows 子系统<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/wsl/" data-bi-name="secondary-nav-link-6-windows-subsystem-for-linux">
						<span><!---->适用于 Linux 的 Windows 子系统<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/powertoys/" data-bi-name="secondary-nav-link-7-microsoft-powertoys">
						<span><!---->Microsoft PowerToys<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
		<li class="dropdown">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  width-full justify-content-space-between padding-inline-xs padding-block-xxs" aria-controls="bx-330" data-bi-name="secondary-nav-btn-3-platforms" value="undefined">
				<span><!---->平台<!----></span>
				<span aria-hidden="true" class="icon  margin-left-xs">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-330" aria-label="平台" data-bi-name="secondary-nav-menu-3-platforms">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/win32/" data-bi-name="secondary-nav-link-1-win32-apps">
						<span><!---->Win32 应用<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/apps/winui/winui3/" data-bi-name="secondary-nav-link-2-winui-3">
						<span><!---->WinUI 3<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/" data-bi-name="secondary-nav-link-3-wpf">
						<span><!---->WPF<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/dotnet/desktop/winforms/" data-bi-name="secondary-nav-link-4-windows-forms">
						<span><!---->Windows 窗体<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/uwp/" data-bi-name="secondary-nav-link-5-uwp">
						<span><!---->UWP<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/web/" data-bi-name="secondary-nav-link-6-web-development-on-windows">
						<span><!---->Windows 上的 Web 开发<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/iot/" data-bi-name="secondary-nav-link-7-windows-for-iot">
						<span><!---->适用于 IoT 的 Windows<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/mixed-reality/" data-bi-name="secondary-nav-link-8-mixed-reality">
						<span><!---->混合现实<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/gaming/gdk/" data-bi-name="secondary-nav-link-9-game-development-kit">
						<span><!---->游戏开发工具包<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
			</ul>
		</li>
	<!---->
		<li class="dropdown">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  site-header-button-icon-chevron" aria-controls="bx-331" data-bi-name="secondary-nav-btn-4-hardware-developers" value="undefined">
				<span><!---->硬件开发人员<!----></span>
				<span aria-hidden="true" class="icon expanded-indicator ">
					<span class="docon docon-chevron-down-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-331" aria-label="硬件开发人员" data-bi-name="secondary-nav-menu-4-hardware-developers">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/" data-bi-name="secondary-nav-link-1-hardware-developer-documentation">
						<span><!---->硬件开发人员文档<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/download-the-wdk/" data-bi-name="secondary-nav-link-2-windows-driver-kit-wdk">
						<span><!---->Windows 驱动程序工具包 (WDK)<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/samples/browse/?products=windows-wdk" data-bi-name="secondary-nav-link-3-wdk-code-samples">
						<span><!---->WDK 代码示例<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/test/hlk/" data-bi-name="secondary-nav-link-4-hardware-lab-kit-hlk">
						<span><!---->Hardware Lab Kit (HLK)<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/get-started/adk-install/" data-bi-name="secondary-nav-link-5-assessment-and-deployment-kit-adk">
						<span><!---->评估和部署工具包 (ADK)<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/debugger/" data-bi-name="secondary-nav-link-6-debugging-tools-for-windows">
						<span><!---->Windows 调试工具<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/get-started/" data-bi-name="secondary-nav-link-7-get-started-building-devices">
						<span><!---->开始构建设备<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
				<li>
					<a data-test-id="header-link-windows-server" class="has-external-link-indicator site-header-button " href="https://learn.microsoft.com/zh-cn/windows-server/" data-bi-name="secondary-nav-link-5-windows-server">
						<span><!---->Windows Server<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a data-test-id="header-link-适用于-iot-的-windows" class="has-external-link-indicator site-header-button " href="https://learn.microsoft.com/zh-cn/windows/iot/" data-bi-name="secondary-nav-link-6-windows-for-iot">
						<span><!---->适用于 IoT 的 Windows<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a data-test-id="header-link-windows-预览体验计划" class="has-external-link-indicator site-header-button " href="https://learn.microsoft.com/zh-cn/windows-insider/" data-bi-name="secondary-nav-link-7-windows-insider-program">
						<span><!---->Windows 预览体验计划<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a data-test-id="header-link-windows-365" class="has-external-link-indicator site-header-button " href="https://learn.microsoft.com/zh-cn/windows-365/" data-bi-name="secondary-nav-link-8-windows-365">
						<span><!---->Windows 365<!----></span>
					</a>
				</li>
		  <!---->
		<li class="dropdown" hidden="">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  site-header-button-icon-chevron" aria-controls="bx-332" data-bi-name="secondary-nav-btn-more" value="undefined">
				<span><!---->更多<!----></span>
				<span aria-hidden="true" class="icon expanded-indicator ">
					<span class="docon docon-chevron-down-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-332" aria-label="更多" data-bi-name="secondary-nav-menu-more">
				<!---->
				<li hidden="">
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/release-health/" data-bi-name="secondary-nav-link-1-release-health">
						<span><!---->发布运行状况<!----></span>
					</a>
				</li>
		  <!---->
		<li class="dropdown" hidden="">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  width-full justify-content-space-between padding-inline-xs padding-block-xxs" aria-controls="bx-333" data-bi-name="secondary-nav-btn-2-windows-client" value="undefined">
				<span><!---->Windows 客户端<!----></span>
				<span aria-hidden="true" class="icon  margin-left-xs">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-333" aria-label="Windows 客户端" data-bi-name="secondary-nav-menu-2-windows-client">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/resources/" data-bi-name="secondary-nav-link-1-windows-client-for-it-pros">
						<span><!---->面向 IT 专业人士的 Windows 客户端<!----></span>
					</a>
				</li>
		  <!---->
		<li class="dropdown">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  width-full justify-content-space-between padding-inline-xs padding-block-xxs" aria-controls="bx-334" data-bi-name="secondary-nav-btn-2-deployment" value="undefined">
				<span><!---->部署<!----></span>
				<span aria-hidden="true" class="icon  margin-left-xs">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-334" aria-label="部署" data-bi-name="secondary-nav-menu-2-deployment">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/mem/autopilot/" data-bi-name="secondary-nav-link-1-windows-autopilot">
						<span><!---->Windows Autopilot<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/deployment/windows-autopatch/" data-bi-name="secondary-nav-link-2-windows-autopatch">
						<span><!---->Windows 自动修补<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/deployment/" data-bi-name="secondary-nav-link-3-deploy-hub">
						<span><!---->部署中心<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/security/" data-bi-name="secondary-nav-link-3-security">
						<span><!---->安全性<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/privacy/" data-bi-name="secondary-nav-link-4-privacy">
						<span><!---->隐私<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/client-management/" data-bi-name="secondary-nav-link-5-client-management">
						<span><!---->客户端管理<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/configuration/" data-bi-name="secondary-nav-link-6-configuration">
						<span><!---->配置<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/education/windows/" data-bi-name="secondary-nav-link-7-windows-for-education">
						<span><!---->Windows 教育版<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/troubleshoot/windows-client/" data-bi-name="secondary-nav-link-8-troubleshooting">
						<span><!---->疑难解答<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
		<li class="dropdown" hidden="">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  width-full justify-content-space-between padding-inline-xs padding-block-xxs" aria-controls="bx-335" data-bi-name="secondary-nav-btn-3-application-developers" value="undefined">
				<span><!---->应用程序开发人员<!----></span>
				<span aria-hidden="true" class="icon  margin-left-xs">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-335" aria-label="应用程序开发人员" data-bi-name="secondary-nav-menu-3-application-developers">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/apps/" data-bi-name="secondary-nav-link-1-windows-app-development-documentation">
						<span><!---->Windows 应用开发文档<!----></span>
					</a>
				</li>
		  <!---->
		<li class="dropdown">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  width-full justify-content-space-between padding-inline-xs padding-block-xxs" aria-controls="bx-336" data-bi-name="secondary-nav-btn-2-app-developer-tools" value="undefined">
				<span><!---->Web 开发人员工具<!----></span>
				<span aria-hidden="true" class="icon  margin-left-xs">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-336" aria-label="Web 开发人员工具" data-bi-name="secondary-nav-menu-2-app-developer-tools">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/apps/windows-app-sdk/" data-bi-name="secondary-nav-link-1-windows-app-sdk">
						<span><!---->Windows 应用 SDK<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/apps/winui/" data-bi-name="secondary-nav-link-2-windows-ui-library">
						<span><!---->Windows UI 库<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/msix/" data-bi-name="secondary-nav-link-3-msix">
						<span><!---->MSIX<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/terminal/" data-bi-name="secondary-nav-link-4-windows-terminal">
						<span><!---->Windows 终端<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/android/wsa/" data-bi-name="secondary-nav-link-5-windows-subsystem-for-android">
						<span><!---->适用于 Android 的 Windows 子系统<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/wsl/" data-bi-name="secondary-nav-link-6-windows-subsystem-for-linux">
						<span><!---->适用于 Linux 的 Windows 子系统<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/powertoys/" data-bi-name="secondary-nav-link-7-microsoft-powertoys">
						<span><!---->Microsoft PowerToys<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
		<li class="dropdown">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  width-full justify-content-space-between padding-inline-xs padding-block-xxs" aria-controls="bx-337" data-bi-name="secondary-nav-btn-3-platforms" value="undefined">
				<span><!---->平台<!----></span>
				<span aria-hidden="true" class="icon  margin-left-xs">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-337" aria-label="平台" data-bi-name="secondary-nav-menu-3-platforms">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/win32/" data-bi-name="secondary-nav-link-1-win32-apps">
						<span><!---->Win32 应用<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/apps/winui/winui3/" data-bi-name="secondary-nav-link-2-winui-3">
						<span><!---->WinUI 3<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/" data-bi-name="secondary-nav-link-3-wpf">
						<span><!---->WPF<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/dotnet/desktop/winforms/" data-bi-name="secondary-nav-link-4-windows-forms">
						<span><!---->Windows 窗体<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/uwp/" data-bi-name="secondary-nav-link-5-uwp">
						<span><!---->UWP<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/web/" data-bi-name="secondary-nav-link-6-web-development-on-windows">
						<span><!---->Windows 上的 Web 开发<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/iot/" data-bi-name="secondary-nav-link-7-windows-for-iot">
						<span><!---->适用于 IoT 的 Windows<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/mixed-reality/" data-bi-name="secondary-nav-link-8-mixed-reality">
						<span><!---->混合现实<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/gaming/gdk/" data-bi-name="secondary-nav-link-9-game-development-kit">
						<span><!---->游戏开发工具包<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
			</ul>
		</li>
	<!---->
		<li class="dropdown" hidden="">
			<button type="button" aria-expanded="false" class="dropdown-trigger site-header-button  width-full justify-content-space-between padding-inline-xs padding-block-xxs" aria-controls="bx-338" data-bi-name="secondary-nav-btn-4-hardware-developers" value="undefined">
				<span><!---->硬件开发人员<!----></span>
				<span aria-hidden="true" class="icon  margin-left-xs">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</button>
			<ul class="dropdown-menu padding-bottom-xxs background-color-body-medium" id="bx-338" aria-label="硬件开发人员" data-bi-name="secondary-nav-menu-4-hardware-developers">
				<!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/" data-bi-name="secondary-nav-link-1-hardware-developer-documentation">
						<span><!---->硬件开发人员文档<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/download-the-wdk/" data-bi-name="secondary-nav-link-2-windows-driver-kit-wdk">
						<span><!---->Windows 驱动程序工具包 (WDK)<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/samples/browse/?products=windows-wdk" data-bi-name="secondary-nav-link-3-wdk-code-samples">
						<span><!---->WDK 代码示例<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/test/hlk/" data-bi-name="secondary-nav-link-4-hardware-lab-kit-hlk">
						<span><!---->Hardware Lab Kit (HLK)<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/get-started/adk-install/" data-bi-name="secondary-nav-link-5-assessment-and-deployment-kit-adk">
						<span><!---->评估和部署工具包 (ADK)<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/debugger/" data-bi-name="secondary-nav-link-6-debugging-tools-for-windows">
						<span><!---->Windows 调试工具<!----></span>
					</a>
				</li>
		  <!---->
				<li>
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-hardware/get-started/" data-bi-name="secondary-nav-link-7-get-started-building-devices">
						<span><!---->开始构建设备<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
				<li hidden="">
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-server/" data-bi-name="secondary-nav-link-5-windows-server">
						<span><!---->Windows Server<!----></span>
					</a>
				</li>
		  <!---->
				<li hidden="">
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows/iot/" data-bi-name="secondary-nav-link-6-windows-for-iot">
						<span><!---->适用于 IoT 的 Windows<!----></span>
					</a>
				</li>
		  <!---->
				<li hidden="">
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-insider/" data-bi-name="secondary-nav-link-7-windows-insider-program">
						<span><!---->Windows 预览体验计划<!----></span>
					</a>
				</li>
		  <!---->
				<li hidden="">
					<a class="has-external-link-indicator site-header-button width-full justify-content-flex-start padding-inline-xs padding-block-xxs " href="https://learn.microsoft.com/zh-cn/windows-365/" data-bi-name="secondary-nav-link-8-windows-365">
						<span><!---->Windows 365<!----></span>
					</a>
				</li>
		  <!---->
			</ul>
		</li>
	<!---->
			</ul>
		</nav>
	
		<span class="nav-bar-spacer"></span>
		 
	 <!----></div><!----></div>
		</header><div id="content-header" class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
				<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
					<button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button="">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">目录</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>退出焦点模式</span>
					</button>
				</div>
			</div><div id="disclaimer-holder" class="has-overflow-hidden has-default-focus"><!---->
			<section data-dismissable="disappearing" data-bi-name="mt-csat-banner" class="is-info alert is-banner">
				<div class="uhf-container">
					<button data-dismiss="" data-bi-name="close" type="button" class="delete position-absolute top-0 right-0 margin-xxs delete-lg">
						<span class="visually-hidden"><!---->消除警报<!----></span>
					</button>
					<div class="columns">
						<div class="column is-12">
							<div class="level justify-content-flex-start">
								<div class="level-left flex-shrink-1">
									<div class="level-item flex-shrink-1">
										<p class="has-text-white-static disclaimer-title margin-top-xxs margin-right-xs has-line-height-reset">
											<span class="icon">
												<span class="docon docon-status-error-outline" aria-hidden="true"></span>
											</span>
											<span><!---->本文原文为英文，已针对你所在市场进行了翻译。 你对所用语言的质量的满意度如何？<!----></span>
										</p>
									</div>
								</div>
								 <div class="level-right margin-xxs margin-none-tablet">
				<div class="level-item justify-content-flex-start padding-xxs-tablet">
					
					<button data-bi-name="CTA" class="button button-info button-sm margin-inline-xxs">
						请告诉我们
					</button>
			  
				</div>
		  </div>
							</div>
						</div>
					</div>
				</div>
			</section>
		<!----></div>
	</div>

	<div class="mainContainer  uhf-container has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile "><div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" aria-label="主要" style="top: 24px; height: calc(-221px + 100vh); max-height: 13330.5px;" data-bi-name="left toc" role="navigation"><form action="javascript:" role="search" aria-label="搜索" class="margin-bottom-xxs"><label class="visually-hidden" for="ax-2">搜索</label><div class="autocomplete display-block" data-bi-name="autocomplete"><!---->
			<div class="field-body control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-2" data-test-id="ax-2" class="autocomplete-input input input-sm
						control has-icons-left
						width-full" type="text" aria-expanded="false" aria-owns="ax-3-listbox" aria-controls="ax-3-listbox" aria-activedescendant="" aria-describedby="ms--ax-2-description" placeholder="按标题筛选" pattern=".*">

				
					<span aria-hidden="true" class="icon is-small is-left">
						<span class="has-text-primary docon docon-filter-settings"></span>
					</span>
			  

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>

				<span hidden="" id="ms--ax-2-description">
					建议将在你键入时进行筛选
				</span>
			</div>

			<ul role="listbox" id="ax-3-listbox" data-test-id="ax-2-listbox" class="autocomplete-suggestions is-vertically-scrollable padding-xxs " aria-label="建议" hidden="">
				
				
			</ul>
		<!----></div></form><ul class="tree table-of-contents is-vertically-scrollable flex-grow-1 flex-shrink-1" role="tree" aria-label="目录" data-bi-name="tree" data-is-collapsible="true"><li role="none"><a aria-setsize="10" aria-level="1" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/introduction">Windows 安全性简介</a></li><li role="none"><a aria-setsize="10" aria-level="1" aria-posinset="2" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/book/">Windows 11安全手册🔗</a></li><li role="none"><a aria-setsize="10" aria-level="1" aria-posinset="3" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/licensing-and-edition-requirements">安全功能许可和版本要求</a></li><li class="tree-item" aria-setsize="10" aria-level="1" aria-posinset="4" role="treeitem" tabindex="-1" id="title-4-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>安全基础</span></li><li class="tree-item" aria-setsize="10" aria-level="1" aria-posinset="5" role="treeitem" tabindex="-1" id="title-5-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>硬件安全性</span></li><li class="tree-item is-expanded" aria-setsize="10" aria-level="1" aria-posinset="6" role="treeitem" tabindex="-1" id="title-6-1" aria-expanded="true"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>操作系统安全性</span><ul class="tree-group" role="group"><li role="none"><a aria-setsize="6" aria-level="2" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/">概述</a></li><li class="tree-item" aria-setsize="6" aria-level="2" aria-posinset="2" role="treeitem" tabindex="-1" id="title-6-1_2-2" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>系统安全性</span></li><li class="tree-item" aria-setsize="6" aria-level="2" aria-posinset="3" role="treeitem" tabindex="-1" id="title-6-1_3-2" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>加密和数据保护</span></li><li class="tree-item" aria-setsize="6" aria-level="2" aria-posinset="4" role="treeitem" tabindex="-1" id="title-6-1_4-2" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>设备管理</span></li><li class="tree-item is-expanded" aria-setsize="6" aria-level="2" aria-posinset="5" role="treeitem" tabindex="-1" id="title-6-1_5-2" aria-expanded="true"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>网络安全</span><ul class="tree-group" role="group"><li role="none"><a aria-setsize="10" aria-level="3" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows-server/security/tls/tls-ssl-schannel-ssp-overview">传输层安全性 (TLS) 🔗</a></li><li role="none"><a aria-setsize="10" aria-level="3" aria-posinset="2" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows-server/networking/dns/doh-client-support">域名系统 (DNS) 安全性 🔗</a></li><li role="none"><a aria-setsize="10" aria-level="3" aria-posinset="3" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://support.microsoft.com/windows/faster-and-more-secure-wi-fi-in-windows-26177a28-38ed-1a8e-7eca-66f24dc63f09">Wi-Fi 安全性</a></li><li role="none"><a aria-setsize="10" aria-level="3" aria-posinset="4" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows-server/networking/technologies/extensible-authentication-protocol/network-access">用于网络访问的可扩展身份验证协议 (EAP)</a></li><li class="tree-item is-expanded" aria-setsize="10" aria-level="3" aria-posinset="5" role="treeitem" tabindex="-1" id="title-6-1_5-2_5-3" aria-expanded="true"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Windows 防火墙</span><ul class="tree-group" role="group"><li role="none"><a aria-setsize="5" aria-level="4" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/">概述</a></li><li role="none"><a aria-setsize="5" aria-level="4" aria-posinset="2" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/rules">防火墙规则概念</a></li><li class="tree-item is-expanded" aria-setsize="5" aria-level="4" aria-posinset="3" role="treeitem" tabindex="-1" id="title-6-1_5-2_5-3_3-4" aria-expanded="true"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>配置和管理 Windows 防火墙</span><ul class="tree-group" role="group"><li role="none"><a aria-setsize="5" aria-level="5" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/tools">配置工具</a></li><li role="none"><a aria-setsize="5" aria-level="5" aria-posinset="2" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/mem/intune/protect/endpoint-security-firewall-policy">使用 Microsoft Intune 进行配置 🔗</a></li><li role="none"><a aria-setsize="5" aria-level="5" aria-posinset="3" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure">使用组策略进行配置</a></li><li role="none"><a aria-setsize="5" aria-level="5" aria-posinset="4" role="treeitem" tabindex="0" class="tree-item is-leaf has-external-link-indicator is-selected" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line" aria-current="page">使用命令行工具进行配置</a></li><li role="none"><a aria-setsize="5" aria-level="5" aria-posinset="5" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/dynamic-keywords">动态关键字</a></li></ul></li><li role="none"><a aria-setsize="5" aria-level="4" aria-posinset="4" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/hyper-v-firewall">Hyper-V 防火墙</a></li><li class="tree-item" aria-setsize="5" aria-level="4" aria-posinset="5" role="treeitem" tabindex="-1" id="title-6-1_5-2_5-3_5-4" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>疑难解答</span></li></ul></li><li class="tree-item" aria-setsize="10" aria-level="3" aria-posinset="6" role="treeitem" tabindex="-1" id="title-6-1_5-2_6-3" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>虚拟专用网络 (VPN)</span></li><li role="none"><a aria-setsize="10" aria-level="3" aria-posinset="7" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows-server/remote/remote-access/vpn/always-on-vpn/">始终使用 VPN 🔗</a></li><li role="none"><a aria-setsize="10" aria-level="3" aria-posinset="8" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows-server/remote/remote-access/directaccess/directaccess">直接访问 🔗</a></li><li role="none"><a aria-setsize="10" aria-level="3" aria-posinset="9" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows-server/storage/file-server/file-server-smb-overview">服务器消息块 (SMB) 文件服务 🔗</a></li><li role="none"><a aria-setsize="10" aria-level="3" aria-posinset="10" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows-server/storage/file-server/smb-direct">服务器消息块直接（SMB 直接）🔗</a></li></ul></li><li class="tree-item" aria-setsize="6" aria-level="2" aria-posinset="6" role="treeitem" tabindex="-1" id="title-6-1_6-2" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>病毒和威胁防护</span></li></ul></li><li class="tree-item" aria-setsize="10" aria-level="1" aria-posinset="7" role="treeitem" tabindex="-1" id="title-7-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>应用程序安全性</span></li><li class="tree-item" aria-setsize="10" aria-level="1" aria-posinset="8" role="treeitem" tabindex="-1" id="title-8-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>身份保护</span></li><li class="tree-item" aria-setsize="10" aria-level="1" aria-posinset="9" role="treeitem" tabindex="-1" id="title-9-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>云安全性</span></li><li role="none"><a aria-setsize="10" aria-level="1" aria-posinset="10" role="treeitem" tabindex="-1" class="tree-item is-leaf has-external-link-indicator" data-bi-name="tree-leaf" href="https://learn.microsoft.com/zh-cn/windows/privacy">Windows 隐私🔗</a></li></ul><div class="padding-xxs padding-none-tablet border-top border-bottom-tablet"><button class="button button-sm button-clear button-block inner-focus justify-content-flex-start-tablet" data-bi-name="download-pdf" rel="nofollow"><!---->
			<span class="icon" aria-hidden="true">
				<span class="docon docon-dictionary-download"></span>
			</span>
			<span><!---->下载 PDF<!----></span>
		<!----></button></div></nav>
			</div><!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps "><div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" class="" role="main" data-bi-name="content" lang="zh-cn" dir="ltr"><!-- article-header -->
							<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
								<div class="display-flex align-items-center "><details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs" hidden="">
										<summary class="button button-clear button-primary button-sm inner-focus" aria-label="所有痕迹">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
										</summary>
										<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none"><!---->
			<nav>
				<ol class="list-style-none">
					<!---->
								<li class="line-clamp-1">
									<a class="display-block has-inner-focus padding-inline-xs padding-block-xxs border-radius font-size-sm" href="https://learn.microsoft.com/zh-cn/">
										Learn
									</a>
								</li>
							<!----><!---->
								<li class="line-clamp-1">
									<a class="display-block has-inner-focus padding-inline-xs padding-block-xxs border-radius font-size-sm" href="https://learn.microsoft.com/zh-cn/windows/resources/">
										Windows
									</a>
								</li>
							<!----><!---->
								<li class="line-clamp-1">
									<a class="display-block has-inner-focus padding-inline-xs padding-block-xxs border-radius font-size-sm" href="https://learn.microsoft.com/zh-cn/windows/security/">
										安全性
									</a>
								</li>
							<!---->
				</ol>
			</nav>
			
		<!----></div>
									</details>

									<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs" style="display: block; white-space: nowrap; overflow: hidden;"><!---->
			<nav>
				<ol class="breadcrumbs">
					<!---->
								<li class="breadcrumbs-item" data-bread-crumbs-collapse-target="">
									<a href="https://learn.microsoft.com/zh-cn/"><!---->Learn<!----></a>
								</li>
							<!----><!---->
								<li class="breadcrumbs-item" data-bread-crumbs-collapse-target="">
									<a href="https://learn.microsoft.com/zh-cn/windows/resources/"><!---->Windows<!----></a>
								</li>
							<!----><!---->
								<li class="breadcrumbs-item" data-bread-crumbs-collapse-target="" style="">
									<a href="https://learn.microsoft.com/zh-cn/windows/security/" style=""><!---->安全性<!----></a>
								</li>
							<!---->
				</ol>
			</nav>
		<!----></bread-crumbs><div id="article-header-page-actions" class="margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"><a id="lang-link-tablet" class="button button-primary button-clear button-sm display-none display-inline-flex-tablet" title="使用英语阅读" data-bi-name="language-toggle" data-read-in-link="" href="https://learn.microsoft.com/en-us/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell" data-bi="{&quot;cN&quot;:&quot;language-toggle&quot;,&quot;value&quot;:&quot;off&quot;}">
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon="">
												<span class="docon docon-locale-globe"></span>
											</span>
											<span class="is-visually-hidden" data-read-in-link-text="">使用英语阅读</span>
										</a><details class="popover popover-right add-item-popover">
		<summary class="button button-clear button-sm button-primary display-none display-inline-flex-tablet" data-list-type="collection" data-list-item-title="使用命令行管理 Windows 防火墙 - Windows Security | Microsoft Learn" data-list-item-url="/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line" data-bi-name="add-to-list" aria-describedby="popover-content" aria-expanded="false">
			
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
												<span class="collection-status is-visually-hidden">保存</span>
											
		</summary>
		<div class="popover-content has-z-index-one">
			<ul class="list-unstyled">
				<li>
					<button class="button button-clear button-sm button-primary" data-list-type="collection" data-list-item-title="使用命令行管理 Windows 防火墙 - Windows Security | Microsoft Learn" data-list-item-url="/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line" data-bi-name="add-to-collections" data-pressed="false" title="将 使用命令行管理 Windows 防火墙 - Windows Security | Microsoft Learn 添加到集合">
						<span class="icon" aria-hidden="true">
							<span class="docon docon-circle-addition"></span>
						</span>
						<span class="collection-status">添加到集合</span>
					</button>
				</li>
				<li>
					<button class="button button-clear button-sm button-primary" data-list-type="plan" data-list-item-title="使用命令行管理 Windows 防火墙 - Windows Security | Microsoft Learn" data-list-item-url="/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line" data-bi-name="add-to-plans" data-pressed="false" title="将 使用命令行管理 Windows 防火墙 - Windows Security | Microsoft Learn 添加到计划">
						<span class="icon" aria-hidden="true">
							<span class="docon docon-circle-addition"></span>
						</span>
						<span class="plan-status">添加到计划</span>
					</button>
				</li>
			</ul>
		</div>
	</details>
										<details class="popover popover-right" id="article-header-page-actions-overflow">
											<summary class="justify-content-flex-start button button-clear button-sm button-primary" aria-label="更多操作" title="更多操作">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
											</summary>
											<div class="popover-content padding-xs"><button data-page-action-item="overflow-mobile" type="button" class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet" data-bi-name="contents-expand" data-contents-button="" data-popover-close="">
														<span class="icon">
															<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
														</span><span class="contents-expand-title">目录</span></button><a id="lang-link-overflow" class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet" title="使用英语阅读" data-bi-name="language-toggle" data-page-action-item="overflow-mobile" data-check-hidden="true" data-read-in-link="" href="https://learn.microsoft.com/en-us/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell" data-bi="{&quot;cN&quot;:&quot;language-toggle&quot;,&quot;value&quot;:&quot;off&quot;}">
													<span class="icon" aria-hidden="true" data-read-in-link-icon="">
														<span class="docon docon-locale-globe"></span>
													</span>
													<span data-read-in-link-text="">使用英语阅读</span>
												</a><button type="button" class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet" data-list-type="collection" data-bi-name="collection" title="将 使用命令行管理 Windows 防火墙 - Windows Security | Microsoft Learn 添加到集合" data-page-action-item="overflow-mobile" data-check-hidden="true" data-popover-close="" data-pressed="false">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="collection-status">添加到集合</span>
													</button>

			 										
													<button type="button" class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet" data-list-type="plan" data-bi-name="plan" title="将 使用命令行管理 Windows 防火墙 - Windows Security | Microsoft Learn 添加到计划" data-page-action-item="overflow-mobile" data-check-hidden="true" data-popover-close="" data-pressed="false">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="plan-status">添加到计划</span>
													</button><div aria-hidden="true" class="margin-none" data-page-action-item="overflow-all"></div>
														<hr class="display-none-tablet margin-bottom-xxs margin-top-xxs">
														<h4 class="font-size-sm padding-left-xxs">通过</h4>

													<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line%3Ftabs%3Dpowershell%26WT.mc_id%3Dfacebook">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-facebook-share font-size-md color-primary"></span>
															</span>
															<span class="margin-left-xxs">Facebook</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line%3Ftabs%3Dpowershell%26WT.mc_id%3Dtwitter&amp;text=%E4%BB%8A%E5%A4%A9%E6%88%91%E5%AE%8C%E6%88%90%E4%BA%86%20%22%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%A1%E7%90%86%20Windows%20%E9%98%B2%E7%81%AB%E5%A2%99%20-%20Windows%20Security%20%7C%20Microsoft%20Learn%22%EF%BC%81%20%E6%88%91%E5%BE%88%E8%87%AA%E8%B1%AA%E8%83%BD%E5%A4%9F%E5%BA%86%E7%A5%9D%E8%BF%99%E4%B8%80%E6%88%90%E5%B0%B1%EF%BC%8C%E5%B9%B6%E5%B8%8C%E6%9C%9B%E8%BF%99%E8%83%BD%E6%BF%80%E5%8A%B1%E4%BD%A0%E5%BC%80%E5%A7%8B%E8%87%AA%E5%B7%B1%E7%9A%84%20%40MicrosoftLearn%20%E6%97%85%E7%A8%8B%EF%BC%81&amp;tw_p=tweetbutton&amp;url=https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line%3Ftabs%3Dpowershell%26WT.mc_id%3Dtwitter">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-xlogo-share font-size-xxs"></span>
															</span>
															<span class="margin-left-xxs">x.com 共享</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all" href="https://www.linkedin.com/feed/?shareActive=true&amp;text=%E4%BB%8A%E5%A4%A9%E6%88%91%E5%AE%8C%E6%88%90%E4%BA%86%20%22%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%A1%E7%90%86%20Windows%20%E9%98%B2%E7%81%AB%E5%A2%99%20-%20Windows%20Security%20%7C%20Microsoft%20Learn%22%EF%BC%81%20%E6%88%91%E5%BE%88%E8%87%AA%E8%B1%AA%E8%83%BD%E5%A4%9F%E5%BA%86%E7%A5%9D%E8%BF%99%E4%B8%80%E6%88%90%E5%B0%B1%EF%BC%8C%E5%B9%B6%E5%B8%8C%E6%9C%9B%E8%BF%99%E8%83%BD%E6%BF%80%E5%8A%B1%E4%BD%A0%E5%BC%80%E5%A7%8B%E8%87%AA%E5%B7%B1%E7%9A%84%20%40MicrosoftLearn%20%E6%97%85%E7%A8%8B%EF%BC%81%0A%0D%0Ahttps%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line%3Ftabs%3Dpowershell%26WT.mc_id%3Dlinkedin">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-linked-in-logo font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">LinkedIn</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start margin-bottom-xxs share-email" data-bi-name="email" data-page-action-item="overflow-all" href="mailto:?subject=%5B%E5%85%B1%E4%BA%AB%E6%96%87%E7%AB%A0%5D%20%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%A1%E7%90%86%20Windows%20%E9%98%B2%E7%81%AB%E5%A2%99%20-%20Windows%20Security%20%7C%20Microsoft%20Learn&amp;body=%E4%BB%8A%E5%A4%A9%E6%88%91%E5%AE%8C%E6%88%90%E4%BA%86%20%22%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%A1%E7%90%86%20Windows%20%E9%98%B2%E7%81%AB%E5%A2%99%20-%20Windows%20Security%20%7C%20Microsoft%20Learn%22%EF%BC%81%20%E6%88%91%E5%BE%88%E8%87%AA%E8%B1%AA%E8%83%BD%E5%A4%9F%E5%BA%86%E7%A5%9D%E8%BF%99%E4%B8%80%E6%88%90%E5%B0%B1%EF%BC%8C%E5%B9%B6%E5%B8%8C%E6%9C%9B%E8%BF%99%E8%83%BD%E6%BF%80%E5%8A%B1%E4%BD%A0%E5%BC%80%E5%A7%8B%E8%87%AA%E5%B7%B1%E7%9A%84%20%40MicrosoftLearn%20%E6%97%85%E7%A8%8B%EF%BC%81%0A%0D%0Ahttps%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line%3Ftabs%3Dpowershell%26WT.mc_id%3Demail">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">电子邮件</span>
														</a><hr>
													<button class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus margin-top-xxs" title="打印" type="button" aria-label="打印" data-bi-name="print" data-page-action-item="overflow-all" data-popover-close="" data-print-page="" data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print font-size-sm color-primary"></span>
														</span>
														<span class="margin-left-xxs">打印</span>
													</button>
											</div>
										</details>
										
									</div></div>
							</div>
							<!-- end article-header --><div>
								<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus" data-bi-name="contents-expand" data-contents-button="" hidden="">
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span><span class="contents-expand-title">目录</span></button>
							</div><!-- end mobile-contents button  -->

							<div class="content "><h1 id="manage-windows-firewall-with-the-command-line">使用命令行管理 Windows 防火墙</h1><div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
										<div class="margin-right-xxs">
											<ul class="metadata page-metadata" data-bi-name="page info" lang="zh-cn" dir="ltr"><li>项目</li><li class="visibility-hidden-visual-diff"><time class="" data-article-date="" aria-label="文章评审日期" datetime="2023-11-22T11:50:00.000Z" data-article-date-source="calculated">2023/11/22</time>
															</li><li class="contributors-holder display-none-print">
															<button aria-label="查看所有参与者" class="contributors-button link-button" data-bi-name="contributors" title="查看所有参与者">1 个参与者</button>
														</li><li class="attributeList-holder">
														<dl class="attributeList">
															<dt>适用于:</dt>
															<dd>✅ <a href="https://learn.microsoft.com/windows/release-health/supported-versions-windows-client" target="_blank">Windows 11</a>, ✅ <a href="https://learn.microsoft.com/windows/release-health/supported-versions-windows-client" target="_blank">Windows 10</a>, ✅ <a href="https://learn.microsoft.com/windows/release-health/windows-server-release-info" target="_blank">Windows Server 2022</a>, ✅ <a href="https://learn.microsoft.com/windows/release-health/windows-server-release-info" target="_blank">Windows Server 2019</a>, ✅ <a href="https://learn.microsoft.com/windows/release-health/windows-server-release-info" target="_blank">Windows Server 2016</a></dd>
														</dl>
													</li></ul>
										</div>
<div id="user-feedback" class="margin-block-xxs display-none-print" data-hide-on-archived="">
	<button id="user-feedback-button" data-test-id="conceptual-feedback-button" class="button button-sm button-clear button-primary" type="button" data-bi-name="user-feedback-button" data-user-feedback-button="">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-like"></span>
		</span>
		<span>反馈</span>
	</button>
</div></div><nav id="center-doc-outline" class="doc-outline display-none-print margin-bottom-sm" data-bi-name="intopic toc" aria-label="本文内容"><!---->
		<h2 id="ms--in-this-article" class="title is-6 margin-block-xs"><!---->本文内容<!----></h2>
		<ol id="content-well-in-this-article-list" class="border-left padding-left-xxs">
			<!---->
					<li class="">
						<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#set-profile-global-defaults"><!---->设置配置文件全局默认值<!----></a>
					</li>
				<!---->
					<li class="">
						<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#deploy-basic-firewall-rules"><!---->部署基本防火墙规则<!----></a>
					</li>
				<!---->
					<li class="">
						<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#manage-remotely"><!---->远程管理<!----></a>
					</li>
				<!---->
					<li class="">
						<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#deploy-basic-ipsec-rule-settings"><!---->部署基本 IPsec 规则设置<!----></a>
					</li>
				<!---->
					<li class="">
						<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#deploy-secure-firewall-rules-with-ipsec"><!---->使用 IPsec 部署安全防火墙规则<!----></a>
					</li>
				<!---->
		</ol>
	<!----></nav><!-- <content> --><p>本文提供了如何使用 PowerShell 和 <code>netsh.exe</code>来管理 Windows 防火墙的示例，它们可用于自动管理 Windows 防火墙。</p>
<div class="heading-wrapper" data-heading-level="h2"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#set-profile-global-defaults" aria-label="节标题：设置配置文件全局默认值"></a><h2 id="set-profile-global-defaults" class="heading-anchor">设置配置文件全局默认值</h2></div>
<p>全局默认值基于每个配置文件设置设备行为。 Windows 防火墙支持域、专用和公共配置文件。</p>
<p>Windows 防火墙会丢弃与允许的未经请求的流量不对应的流量，或者为响应设备请求而发送的流量。 如果发现未强制实施所创建的规则，则可能需要启用 Windows 防火墙。 下面介绍如何在本地设备上启用 Windows 防火墙：</p>
<div class="tabGroup" id="tabgroup_1" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_1_powershell" role="tab" aria-controls="tabpanel_1_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_1_cmd" role="tab" aria-controls="tabpanel_1_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_1_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-0" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Set-NetFirewallProfile</span><span class="hljs-parameter"> -Profile</span> Domain,Public,Private<span class="hljs-parameter"> -Enabled</span> True
</span></code></pre>
</section>
<section id="tabpanel_1_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-1" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh.exe advfirewall <span class="hljs-built_in">set</span> allprofiles state on
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#control-windows-firewall-behavior" aria-label="节标题：控制 Windows 防火墙行为"></a><h3 id="control-windows-firewall-behavior" class="heading-anchor">控制 Windows 防火墙行为</h3></div>
<p>可以通过命令行接口定义全局默认设置。 这些修改也可通过 Windows 防火墙控制台获得。
以下 scriptlet 设置默认的入站和出站操作，指定受保护的网络连接，并允许在阻止程序接收入站连接时向用户显示通知。 它允许对多播或广播网络流量进行单播响应，并指定用于故障排除的日志记录设置。</p>
<div class="tabGroup" id="tabgroup_2" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_2_powershell" role="tab" aria-controls="tabpanel_2_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_2_cmd" role="tab" aria-controls="tabpanel_2_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_2_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-2" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-pscommand">Set-NetFirewallProfile</span><span class="hljs-parameter"> -DefaultInboundAction</span> Block<span class="hljs-parameter"> -DefaultOutboundAction</span> Allow<span class="hljs-parameter"> -NotifyOnListen</span> True<span class="hljs-parameter"> -AllowUnicastResponseToMulticast</span> True<span class="hljs-parameter"> -LogFileName</span> %SystemRoot%\System32\LogFiles\Firewall\pfirewall.log
</span></code></pre>
</section>
<section id="tabpanel_2_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-3" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall <span class="hljs-built_in">set</span> allprofiles firewallpolicy blockinbound,allowoutbound
netsh advfirewall <span class="hljs-built_in">set</span> allprofiles settings inboundusernotification enable
netsh advfirewall <span class="hljs-built_in">set</span> allprofiles settings unicastresponsetomulticast enable
netsh advfirewall <span class="hljs-built_in">set</span> allprofiles logging filename <span class="hljs-variable">%SystemRoot%</span>\System32\LogFiles\Firewall\pfirewall.log
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#disable-windows-firewall" aria-label="节标题：禁用 Windows 防火墙"></a><h3 id="disable-windows-firewall" class="heading-anchor">禁用 Windows 防火墙</h3></div>
<p>Microsoft 建议不要禁用 Windows 防火墙，因为你失去了该服务提供的其他优势，例如能够使用 Internet 协议安全 (IPsec) 连接安全规则、网络保护免受采用网络指纹识别的攻击、 <a href="https://go.microsoft.com/fwlink/?linkid=104976" data-linktype="external">Windows 服务强化</a>和 <a href="https://blogs.technet.microsoft.com/networking/2009/03/24/stopping-the-windows-authenticating-firewall-service-and-the-boot-time-policy/" data-linktype="external">启动时间筛选器</a>。
禁用 Windows 防火墙也可能导致问题，包括：</p>
<ul>
<li>“开始”菜单可停止工作</li>
<li>新式应用程序可能无法安装或更新</li>
<li>通过手机激活 Windows 失败</li>
<li>依赖于 Windows 防火墙的应用程序或 OS 不兼容</li>
</ul>
<p>Microsoft 建议仅在安装非 Microsoft 防火墙时禁用 Windows 防火墙，并在禁用或删除非 Microsoft 软件时将 Windows 防火墙重置回默认值。
如果需要禁用 Windows 防火墙，请不要通过在 <strong>服务</strong> 管理单元中停止 Windows 防火墙服务 (来禁用它，显示名称为 Windows 防火墙，服务名称为 MpsSvc) 。
Microsoft 不支持停止 Windows 防火墙服务。
非 Microsoft 防火墙软件只能以编程方式禁用需要禁用的 Windows 防火墙部分以确保兼容性。
不应出于此目的自行禁用防火墙。
禁用 Windows 防火墙的正确方法是禁用 Windows 防火墙配置文件，使服务保持运行状态。
使用以下过程关闭防火墙，或禁用组策略设置<strong>计算机配置|管理模板 |网络|网络Connections|Windows 防火墙 |域 Prolfile |Windows 防火墙：保护所有网络连接</strong>。
有关详细信息，请参阅 <a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/windows-firewall-with-advanced-security-deployment-guide" data-linktype="relative-path">Windows 防火墙部署指南</a>。
以下示例对所有配置文件禁用 Windows 防火墙。</p>
<div class="tabGroup" id="tabgroup_3" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_3_powershell" role="tab" aria-controls="tabpanel_3_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_3_cmd" role="tab" aria-controls="tabpanel_3_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_3_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-4" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Set-NetFirewallProfile</span><span class="hljs-parameter"> -Profile</span> Domain,Public,Private<span class="hljs-parameter"> -Enabled</span> False
</span></code></pre>
</section>
<section id="tabpanel_3_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">
</section>
</div>
<div class="heading-wrapper" data-heading-level="h2"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#deploy-basic-firewall-rules" aria-label="节标题：部署基本防火墙规则"></a><h2 id="deploy-basic-firewall-rules" class="heading-anchor">部署基本防火墙规则</h2></div>
<p>本部分提供用于创建、修改和删除防火墙规则的 scriptlet 示例。</p>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#create-firewall-rules" aria-label="节标题：创建防火墙规则"></a><h3 id="create-firewall-rules" class="heading-anchor">创建防火墙规则</h3></div>
<p>在 Windows PowerShell 中添加防火墙规则看起来非常类似于 Netsh 中的防火墙规则，但参数和值的指定方式不同。
下面是如何允许 Telnet 应用程序在网络上侦听的示例。 此防火墙规则使用 关键字 (keyword) 而不是 IP 地址将范围限定为本地子网。 就像在 Netsh 中一样，规则是在本地设备上创建的，并且会立即生效。</p>
<div class="tabGroup" id="tabgroup_4" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_4_powershell" role="tab" aria-controls="tabpanel_4_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_4_cmd" role="tab" aria-controls="tabpanel_4_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_4_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-5" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-pscommand">New-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Allow Inbound Telnet"</span><span class="hljs-parameter"> -Direction</span> Inbound<span class="hljs-parameter"> -Program</span> %SystemRoot%\System32\tlntsvr.exe<span class="hljs-parameter"> -RemoteAddress</span> LocalSubnet<span class="hljs-parameter"> -Action</span> Allow
</span></code></pre>
</section>
<section id="tabpanel_4_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-6" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall firewall add rule name="Allow Inbound Telnet" <span class="hljs-built_in">dir</span>=<span class="hljs-keyword">in</span> program= <span class="hljs-variable">%SystemRoot%</span>\System32\tlntsvr.exe remoteip=localsubnet action=allow
</span></code></pre>
</section>
</div>

<p>以下 scriptlet 演示如何添加一个基本的防火墙规则，该规则阻止从特定应用程序和本地端口到 Active Directory 中的 组策略 对象 (GPO) 的出站流量。 在 Windows PowerShell 中，策略存储被指定为 <strong>New-NetFirewall</strong> cmdlet 中的参数。 在 Netsh 中，必须首先指定 Netsh 会话中的命令应修改的 GPO。 输入的命令针对 GPO 的内容运行，执行将一直有效，直到 Netsh 会话结束或执行另一个 set store 命令为止。
此处<strong>，domain.contoso.com</strong> 是Active Directory 域服务 (AD DS) 的名称，<strong>gpo_name</strong>是要修改的 GPO 的名称。 如果 GPO 名称中有任何空格，则需要引号。</p>
<div class="tabGroup" id="tabgroup_5" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_5_powershell" role="tab" aria-controls="tabpanel_5_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_5_cmd" role="tab" aria-controls="tabpanel_5_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_5_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-7" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-pscommand">New-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Block Outbound Telnet"</span><span class="hljs-parameter"> -Direction</span> Outbound<span class="hljs-parameter"> -Program</span> %SystemRoot%\System32\tlntsvr.exe<span class="hljs-parameter"> -Protocol</span> TCP<span class="hljs-parameter"> -LocalPort</span> <span class="hljs-number">23</span><span class="hljs-parameter"> -Action</span> Block<span class="hljs-parameter"> -PolicyStore</span> domain.contoso.com\gpo_name
</span></code></pre>
</section>
<section id="tabpanel_5_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-8" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall <span class="hljs-built_in">set</span> store gpo=domain.contoso.com\gpo_name
netsh advfirewall firewall add rule name="Block Outbound Telnet" <span class="hljs-built_in">dir</span>=out program=<span class="hljs-variable">%SystemRoot%</span>\System32\telnet.exe protocol=tcp localport=<span class="hljs-number">23</span> action=block
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#gpo-caching" aria-label="节标题：GPO 缓存"></a><h3 id="gpo-caching" class="heading-anchor">GPO 缓存</h3></div>
<p>为了减轻繁忙的域控制器的负担，Windows PowerShell允许将 GPO 加载到本地会话，在该会话中进行所有更改，然后一次性保存。
以下命令通过向 GPO) 添加 Telnet 规则来执行与上一示例 (相同的操作，但我们通过在 PowerShell 中应用 GPO 缓存来执行此操作。 Netsh 不支持通过将 GPO 加载到本地会话并使用 <em>-GPOSession</em> 参数来更改 GPO</p>
<div class="codeHeader" id="code-try-9" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-variable">$gpo</span> = <span class="hljs-pscommand">Open-NetGPO</span><span class="hljs-parameter"> -PolicyStore</span> domain.contoso.com\gpo_name
<span class="hljs-pscommand">New-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Block Outbound Telnet"</span><span class="hljs-parameter"> -Direction</span> Outbound<span class="hljs-parameter"> -Program</span> %SystemRoot%\System32\telnet.exe<span class="hljs-parameter"> -Protocol</span> TCP<span class="hljs-parameter"> -LocalPort</span> <span class="hljs-number">23</span><span class="hljs-parameter"> -Action</span> Block<span class="hljs-parameter"> -GPOSession</span> <span class="hljs-variable">$gpo</span>
<span class="hljs-pscommand">Save-NetGPO</span><span class="hljs-parameter"> -GPOSession</span> <span class="hljs-variable">$gpo</span>
</span></code></pre>
<p>此命令不会对单个更改进行批处理，它会同时加载并保存整个 GPO。 因此，如果其他管理员或在其他Windows PowerShell窗口中进行了任何其他更改，保存 GPO 将覆盖这些更改。</p>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#modify-an-existing-firewall-rule" aria-label="节标题：修改现有防火墙规则"></a><h3 id="modify-an-existing-firewall-rule" class="heading-anchor">修改现有防火墙规则</h3></div>
<p>创建规则时，Netsh 和 Windows PowerShell 允许更改规则属性和影响，但规则在 Windows PowerShell 中保留其唯一标识符 (，此标识符使用 <em>-Name</em> 参数) 指定。
例如，可以有一个规则 <strong>“允许 Web 80</strong> ”为入站未经请求的流量启用 TCP 端口 80。 可以更改规则，以匹配 Web 服务器的其他远程 IP 地址，通过指定规则的用户可读的本地化名称来允许其流量。</p>
<div class="tabGroup" id="tabgroup_6" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_6_powershell" role="tab" aria-controls="tabpanel_6_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_6_cmd" role="tab" aria-controls="tabpanel_6_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_6_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-10" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Set-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Allow Web 80"</span><span class="hljs-parameter"> -RemoteAddress</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">0.2</span>
</span></code></pre>
</section>
<section id="tabpanel_6_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-11" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall firewall <span class="hljs-built_in">set</span> rule name="Allow Web <span class="hljs-number">80</span>" new remoteip=<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">2</span>
</span></code></pre>
</section>
</div>

<p>Netsh 要求你提供要更改的规则的名称，我们没有其他方法获取防火墙规则。 在Windows PowerShell中，可以使用规则的已知属性查询规则。
运行 <code>Get-NetFirewallRule</code>时，你可能会注意到地址和端口等常见条件未出现。 这些条件在名为 Filters 的单独对象中表示。 如前所述，可以在 New-NetFirewallRule 和 Set-NetFirewallRule 中设置所有条件。 如果要基于这些字段 (端口、地址、安全性、接口、服务) 查询防火墙规则，则需要自行获取筛选器对象。
可以更改 <strong>允许 Web 80</strong> 规则 (的远程终结点，就像之前使用筛选器对象) 一样。 使用 Windows PowerShell，使用端口筛选器按端口进行查询，然后假设存在影响本地端口的其他规则，则使用进一步的查询进行生成，直到检索到所需的规则。
在以下示例中，假设查询返回单个防火墙规则，然后利用Windows PowerShell的管道输入功能通过管道将规则传递给 <code>Set-NetFirewallRule</code> cmdlet。</p>
<div class="codeHeader" id="code-try-12" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-pscommand">Get-NetFirewallPortFilter</span> | ?{<span class="hljs-variable">$_</span>.LocalPort<span class="hljs-nomarkup"> -eq</span> <span class="hljs-number">80</span>} | <span class="hljs-pscommand">Get-NetFirewallRule</span> | ?{ <span class="hljs-variable">$_</span>.Direction<span class="hljs-nomarkup"> -eq</span> <span class="hljs-string">"Inbound"</span><span class="hljs-parameter"> -and</span> <span class="hljs-variable">$_</span>.Action<span class="hljs-nomarkup"> -eq</span> <span class="hljs-string">"Allow"</span>} | <span class="hljs-pscommand">Set-NetFirewallRule</span><span class="hljs-parameter"> -RemoteAddress</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">0.2</span>
</span></code></pre>
<p>还可以使用通配符查询规则。 以下示例返回与特定程序关联的防火墙规则数组。 可以在后续 <code>Set-NetFirewallRule</code> cmdlet 中修改数组的元素。</p>
<div class="codeHeader" id="code-try-13" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Get-NetFirewallApplicationFilter</span><span class="hljs-parameter"> -Program</span> <span class="hljs-string">"*svchost*"</span> | <span class="hljs-pscommand">Get-NetFirewallRule</span>
</span></code></pre>
<p>在 Set 命令中指定关联的组名称时，可以同时修改组中的多个规则。 可以将防火墙规则添加到指定的管理组，以便管理共享相同影响的多个规则。
在以下示例中，我们将入站和出站 Telnet 防火墙规则添加到 <strong>组 Telnet Management</strong>。 在 Windows PowerShell 中，首次创建规则时指定组成员身份，因此我们重新创建前面的示例规则。 在 Netsh 中无法向自定义规则组添加规则。</p>
<div class="codeHeader" id="code-try-14" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-pscommand">New-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Allow Inbound Telnet"</span><span class="hljs-parameter"> -Direction</span> Inbound<span class="hljs-parameter"> -Program</span> %SystemRoot%\System32\tlntsvr.exe<span class="hljs-parameter"> -RemoteAddress</span> LocalSubnet<span class="hljs-parameter"> -Action</span> Allow<span class="hljs-parameter"> -Group</span> <span class="hljs-string">"Telnet Management"</span>
<span class="hljs-pscommand">New-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Block Outbound Telnet"</span><span class="hljs-parameter"> -Direction</span> Outbound<span class="hljs-parameter"> -Program</span> %SystemRoot%\System32\tlntsvr.exe<span class="hljs-parameter"> -RemoteAddress</span> LocalSubnet<span class="hljs-parameter"> -Action</span> Allow<span class="hljs-parameter"> -Group</span> <span class="hljs-string">"Telnet Management"</span>
</span></code></pre>
<p>如果在规则创建时未指定该组，则可以在Windows PowerShell中使用点表示法将该规则添加到规则组。 不能使用 <code>Set-NetFirewallRule</code> 指定组，因为 命令允许按规则组进行查询。</p>
<div class="codeHeader" id="code-try-15" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-variable">$rule</span> = <span class="hljs-pscommand">Get-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Allow Inbound Telnet"</span>
<span class="hljs-variable">$rule</span>.Group = <span class="hljs-string">"Telnet Management"</span>
<span class="hljs-variable">$rule</span> | <span class="hljs-pscommand">Set-NetFirewallRule</span>
</span></code></pre>
<p>在 命令的帮助下 <code>Set</code> ，如果指定了规则组名称，则不会修改组成员身份，而是组的所有规则都会收到由给定参数指示的相同修改。
以下 scriptlet 在包含影响防火墙规则的远程管理的预定义组中启用所有规则。</p>
<div class="tabGroup" id="tabgroup_7" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_7_powershell" role="tab" aria-controls="tabpanel_7_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_7_cmd" role="tab" aria-controls="tabpanel_7_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_7_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-16" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Set-NetFirewallRule</span><span class="hljs-parameter"> -DisplayGroup</span> <span class="hljs-string">"Windows Firewall Remote Management"</span><span class="hljs-parameter"> -Enabled</span> True
</span></code></pre>
</section>
<section id="tabpanel_7_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-17" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall firewall <span class="hljs-built_in">set</span> rule group="Windows Firewall remote management" new enable=yes
</span></code></pre>
</section>
</div>

<p>还有一个单独的 <code>Enable-NetFirewallRule</code> cmdlet 用于按组或规则的其他属性启用规则。</p>
<div class="codeHeader" id="code-try-18" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Enable-NetFirewallRule</span><span class="hljs-parameter"> -DisplayGroup</span> <span class="hljs-string">"Windows Firewall Remote Management"</span><span class="hljs-parameter"> -Verbose</span>
</span></code></pre>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#delete-a-firewall-rule" aria-label="节标题：删除防火墙规则"></a><h3 id="delete-a-firewall-rule" class="heading-anchor">删除防火墙规则</h3></div>
<p>可以禁用规则对象，使其不再处于活动状态。 在 <strong>Windows PowerShell，Disable-NetFirewallRule</strong> cmdlet 会将规则保留在系统上，但将其置于禁用状态，以便不再应用规则并影响流量。 <strong>Enable-NetFirewallRule</strong> 可以重新启用已禁用的防火墙规则。 此 cmdlet 不同于 <strong>Remove-NetFirewallRule</strong>，后者从设备中永久删除规则定义。
以下 cmdlet 从本地策略存储中删除指定的现有防火墙规则。</p>
<div class="tabGroup" id="tabgroup_8" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_8_powershell" role="tab" aria-controls="tabpanel_8_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_8_cmd" role="tab" aria-controls="tabpanel_8_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_8_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-19" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Remove-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Allow Web 80"</span>
</span></code></pre>
</section>
<section id="tabpanel_8_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-20" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall firewall delete rule name="Allow Web <span class="hljs-number">80</span>"
</span></code></pre>
</section>
</div>

<p>与其他 cmdlet 一样，还可以查询要删除的规则。 在这里，将从设备中删除所有阻止防火墙规则。</p>
<div class="codeHeader" id="code-try-21" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Remove-NetFirewallRule</span><span class="hljs-parameter"> -Action</span> Block
</span></code></pre>
<p>使用 <strong>Get</strong> 命令查询规则并将其保存在变量中，观察要受影响的规则，然后通过管道将其传递给 <strong>Remove</strong> 命令，这可能更加安全，就像我们对 <strong>Set</strong> 命令所做的那样。 以下示例演示如何查看所有阻止防火墙规则，然后删除前四个规则。</p>
<div class="codeHeader" id="code-try-22" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-variable">$x</span> = <span class="hljs-pscommand">Get-NetFirewallRule</span><span class="hljs-parameter"> -Action</span> Block
<span class="hljs-variable">$x</span>
<span class="hljs-variable">$x</span>[<span class="hljs-number">0</span>-<span class="hljs-number">3</span>] | <span class="hljs-pscommand">Remove-NetFirewallRule</span>
</span></code></pre>
<div class="heading-wrapper" data-heading-level="h2"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#manage-remotely" aria-label="节标题：远程管理"></a><h2 id="manage-remotely" class="heading-anchor">远程管理</h2></div>
<p>默认情况下启用使用 WinRM 的远程管理。 支持 <em>CimSession</em> 参数的 cmdlet 使用 WinRM，默认情况下可以远程管理。
以下示例返回名为 <strong>RemoteDevice</strong> 的设备上的持久存储的所有防火墙规则。</p>
<div class="codeHeader" id="code-try-23" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Get-NetFirewallRule</span><span class="hljs-parameter"> -CimSession</span> RemoteDevice
</span></code></pre>
<p>可以使用 <em>-CimSession</em> 参数在远程设备上执行任何修改或查看规则。 此处我们从远程设备中删除特定的防火墙规则。</p>
<div class="codeHeader" id="code-try-24" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-variable">$RemoteSession</span> = <span class="hljs-pscommand">New-CimSession</span><span class="hljs-parameter"> -ComputerName</span> RemoteDevice
<span class="hljs-pscommand">Remove-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"AllowWeb80"</span><span class="hljs-parameter"> -CimSession</span> <span class="hljs-variable">$RemoteSession</span><span class="hljs-parameter"> -Confirm</span>
</span></code></pre>
<div class="heading-wrapper" data-heading-level="h2"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#deploy-basic-ipsec-rule-settings" aria-label="节标题：部署基本 IPsec 规则设置"></a><h2 id="deploy-basic-ipsec-rule-settings" class="heading-anchor">部署基本 IPsec 规则设置</h2></div>
<p>Internet 协议安全 (IPsec) 策略由确定 IPsec 行为的规则组成。 IPsec 支持网络级对等身份验证、数据源身份验证、数据完整性、数据机密性 (加密) 和重播保护。
Windows PowerShell可以创建功能强大的复杂 IPsec 策略，例如在 Netsh 和 Windows 防火墙控制台中。 但是，由于Windows PowerShell基于对象而不是基于字符串令牌，因此Windows PowerShell中的配置提供了更大的控制和灵活性。
在 Netsh 中，身份验证和加密集被指定为特定格式的逗号分隔令牌列表。 在Windows PowerShell中，你首先创建所需的身份验证或加密建议对象，并按首选顺序将它们捆绑到列表中，而不是使用默认设置。 然后，创建一个或多个引用这些集的 IPsec 规则。 此模型的优点是，以编程方式访问规则中的信息要容易得多。 有关阐明示例，请参阅以下部分。
<img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/createipsecrule.gif" alt="用于创建单个 ipsec 规则的对象模型。" data-linktype="relative-path"></p>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#create-ipsec-rules" aria-label="节标题：创建 IPsec 规则"></a><h3 id="create-ipsec-rules" class="heading-anchor">创建 IPsec 规则</h3></div>
<p>以下 cmdlet 在 组策略 对象中创建基本 IPsec 传输模式规则。 IPsec 规则易于创建;只需要显示名称，其余属性使用默认值。 入站流量使用默认快速模式和main模式设置进行身份验证并检查完整性。 可以在控制台的“自定义 IPsec 默认值”下找到这些默认设置。</p>
<div class="tabGroup" id="tabgroup_9" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_9_powershell" role="tab" aria-controls="tabpanel_9_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_9_cmd" role="tab" aria-controls="tabpanel_9_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_9_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-25" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">New-NetIPsecRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Require Inbound Authentication"</span><span class="hljs-parameter"> -PolicyStore</span> domain.contoso.com\gpo_name
</span></code></pre>
</section>
<section id="tabpanel_9_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-26" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall <span class="hljs-built_in">set</span> store gpo=domain.contoso.com\gpo_name
netsh advfirewall consec add rule name="Require Inbound Authentication" endpoint1=any endpoint2=any action=requireinrequestout
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#add-custom-authentication-methods-to-an-ipsec-rule" aria-label="节标题：向 IPsec 规则添加自定义身份验证方法"></a><h3 id="add-custom-authentication-methods-to-an-ipsec-rule" class="heading-anchor">向 IPsec 规则添加自定义身份验证方法</h3></div>
<p>如果要在 IPsec 规则对象中创建一组同时包含 AH 和 ESP 的自定义快速模式建议，可以单独创建关联的对象并链接其关联。 有关身份验证方法的详细信息，请参阅 <a href="https://learn.microsoft.com/zh-cn/previous-versions/windows/it-pro/windows-server-2003/cc757847(v=ws.10)" data-linktype="absolute-path">选择 IPsec 协议</a>。
然后，可以在创建 IPsec 规则时使用新创建的自定义快速模式策略。 加密集对象链接到 IPsec 规则对象。
<img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/qmcryptoset.gif" alt="crypto set 对象。" data-linktype="relative-path"> 在此示例中，我们通过指定自定义快速模式加密集来构建以前创建的 IPsec 规则。 最终的 IPsec 规则要求出站流量通过指定的加密方法进行身份验证。</p>
<div class="tabGroup" id="tabgroup_10" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_10_powershell" role="tab" aria-controls="tabpanel_10_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_10_cmd" role="tab" aria-controls="tabpanel_10_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_10_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-27" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-variable">$AHandESPQM</span> = <span class="hljs-pscommand">New-NetIPsecQuickModeCryptoProposal</span><span class="hljs-parameter"> -Encapsulation</span> AH,ESP<span class="hljs-parameter"> -AHHash</span> SHA1<span class="hljs-parameter"> -ESPHash</span> SHA1<span class="hljs-parameter"> -Encryption</span> DES3
<span class="hljs-variable">$QMCryptoSet</span> = <span class="hljs-pscommand">New-NetIPsecQuickModeCryptoSet</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"ah:sha1+esp:sha1-des3"</span><span class="hljs-parameter"> -Proposal</span> <span class="hljs-variable">$AHandESPQM</span><span class="hljs-parameter"> -PolicyStore</span> domain.contoso.com\gpo_name
<span class="hljs-pscommand">New-NetIPsecRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Require Inbound Authentication"</span><span class="hljs-parameter"> -InboundSecurity</span> Require<span class="hljs-parameter"> -OutboundSecurity</span> Request<span class="hljs-parameter"> -QuickModeCryptoSet</span> <span class="hljs-variable">$QMCryptoSet</span>.Name<span class="hljs-parameter"> -PolicyStore</span> domain.contoso.com\gpo_name
</span></code></pre>
</section>
<section id="tabpanel_10_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-28" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall <span class="hljs-built_in">set</span> store gpo=domain.contoso.com\gpo_name
netsh advfirewall consec add rule name="Require Outbound Authentication" endpoint1=any endpoint2=any action=requireinrequestout qmsecmethods=ah:sha1+esp:sha1-<span class="hljs-number">3</span>des
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#ikev2-ipsec-transport-rules" aria-label="节标题：IKEv2 IPsec 传输规则"></a><h3 id="ikev2-ipsec-transport-rules" class="heading-anchor">IKEv2 IPsec 传输规则</h3></div>
<p>企业网络可能需要保护与其他机构的通信。 但是，你发现该机构运行非 Windows 操作系统，并需要使用 Internet 密钥交换版本 2 (IKEv2) 标准。
通过在 IPsec 规则中将 IKEv2 指定为关键模块，可以在 Windows Server 2012 中应用 IKEv2 功能。 此功能规范只能使用计算机证书身份验证完成，不能与阶段 2 身份验证一起使用。</p>
<div class="codeHeader" id="code-try-29" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-pscommand">New-NetIPsecRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Require Inbound Authentication"</span><span class="hljs-parameter"> -InboundSecurity</span> Require<span class="hljs-parameter"> -OutboundSecurity</span> Request<span class="hljs-parameter"> -Phase1AuthSet</span> MyCertAuthSet<span class="hljs-parameter"> -KeyModule</span> IKEv2<span class="hljs-parameter"> -RemoteAddress</span> <span class="hljs-variable">$nonWindowsGateway</span>
</span></code></pre>
<p>有关 IKEv2 的详细信息（包括方案），请参阅<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/securing-end-to-end-ipsec-connections-by-using-ikev2" data-linktype="relative-path">使用 IKEv2 保护端到端 IPsec Connections</a>。</p>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#copy-an-ipsec-rule-from-one-policy-to-another" aria-label="节标题：将 IPsec 规则从一个策略复制到另一个策略"></a><h3 id="copy-an-ipsec-rule-from-one-policy-to-another" class="heading-anchor">将 IPsec 规则从一个策略复制到另一个策略</h3></div>
<p>可以复制具有相同规则属性的防火墙和 IPsec 规则，以简化在不同策略存储中重新创建它们的任务。
若要将以前创建的规则从一个策略存储复制到另一个策略存储区，还必须单独复制关联的对象。 无需复制关联的防火墙筛选器。 可以按与其他 cmdlet 相同的方式查询要复制的规则。
复制单个规则是无法通过 Netsh 接口完成的任务。 下面介绍如何使用 Windows PowerShell 完成此操作。</p>
<div class="codeHeader" id="code-try-30" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-variable">$Rule</span> = <span class="hljs-pscommand">Get-NetIPsecRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Require Inbound Authentication"</span>
<span class="hljs-variable">$Rule</span> | <span class="hljs-pscommand">Copy-NetIPsecRule</span><span class="hljs-parameter"> -NewPolicyStore</span> domain.costoso.com\new_gpo_name
<span class="hljs-variable">$Rule</span> | <span class="hljs-pscommand">Copy-NetPhase1AuthSet</span><span class="hljs-parameter"> -NewPolicyStore</span> domain.costoso.com\new_gpo_name
</span></code></pre>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#handling-windows-powershell-errors" aria-label="节标题：处理Windows PowerShell错误"></a><h3 id="handling-windows-powershell-errors" class="heading-anchor">处理Windows PowerShell错误</h3></div>
<p>若要处理Windows PowerShell脚本中的错误，可以使用 <em>-ErrorAction</em> 参数。 此参数对于 <strong>Remove</strong> cmdlet 特别有用。 如果想要删除特定规则，你会注意到，如果找不到该规则，则它失败。 删除规则时，如果规则尚不存在，可以忽略该错误。 在这种情况下，可以执行以下操作，以禁止在删除操作期间出现任何“未找到规则”错误。</p>
<div class="codeHeader" id="code-try-31" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Remove-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Contoso Messenger 98"</span><span class="hljs-parameter"> -ErrorAction</span> SilentlyContinue
</span></code></pre>
<p>使用通配符也可以禁止显示错误，但它们可能会匹配你不打算删除的规则。 这些通配符可能是一个有用的快捷方式，但仅当知道不会意外删除任何额外的规则时，才应使用。 因此，以下 cmdlet 还会删除该规则，从而禁止出现任何“未找到”错误。</p>
<div class="codeHeader" id="code-try-32" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Remove-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Contoso Messenger 98*"</span>
</span></code></pre>
<p>使用通配符时，如果要双检查匹配的规则集，可以使用 <em>-WhatIf</em> 参数。</p>
<div class="codeHeader" id="code-try-33" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Remove-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Contoso Messenger 98*"</span><span class="hljs-parameter"> -WhatIf</span>
</span></code></pre>
<p>如果只想删除某些匹配的规则，可以使用 <em>-Confirm</em> 参数获取逐条规则确认提示。</p>
<div class="codeHeader" id="code-try-34" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Remove-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Contoso Messenger 98*"</span><span class="hljs-parameter"> -Confirm</span>
</span></code></pre>
<p>还可以仅执行整个操作，在执行操作时显示每个规则的名称。</p>
<div class="codeHeader" id="code-try-35" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Remove-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Contoso Messenger 98*"</span><span class="hljs-parameter"> -Verbose</span>
</span></code></pre>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#monitor" aria-label="节标题：监视器"></a><h3 id="monitor" class="heading-anchor">监视器</h3></div>
<p>以下Windows PowerShell命令在部署阶段的更新周期中非常有用。
若要允许查看特定存储区中的所有 IPsec 规则，可以使用以下命令。 在 Netsh 中，此命令不显示 profile=domain，public 或 profile=domain，private 的规则。 它仅显示具有规则中包含的单个条目域的规则。 以下命令示例将显示所有配置文件中的 IPsec 规则。</p>
<div class="tabGroup" id="tabgroup_11" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_11_powershell" role="tab" aria-controls="tabpanel_11_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_11_cmd" role="tab" aria-controls="tabpanel_11_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_11_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-36" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Show-NetIPsecRule</span><span class="hljs-parameter"> -PolicyStore</span> ActiveStore
</span></code></pre>
</section>
<section id="tabpanel_11_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-37" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall consec show rule name=all
</span></code></pre>
</section>
</div>

<p>可以监视main模式安全关联，了解哪些对等方当前已连接到设备，以及哪个保护套件用于形成安全关联。
使用以下 cmdlet 查看现有的main模式规则及其安全关联：</p>
<div class="tabGroup" id="tabgroup_12" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_12_powershell" role="tab" aria-controls="tabpanel_12_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_12_cmd" role="tab" aria-controls="tabpanel_12_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_12_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-38" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Get-NetIPsecMainModeSA</span>
</span></code></pre>
</section>
<section id="tabpanel_12_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-39" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall monitor show mmsa all
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#find-the-source-gpo-of-a-rule" aria-label="节标题：查找规则的源 GPO"></a><h3 id="find-the-source-gpo-of-a-rule" class="heading-anchor">查找规则的源 GPO</h3></div>
<p>若要查看特定规则或规则组的属性，请查询该规则。 当查询返回指定为 <strong>NotConfigured 的</strong>字段时，可以确定规则源自哪个策略存储。
对于来自 GPO (<em>-PolicyStoreSourceType</em> 参数在 <strong>Show</strong> 命令) 中指定为 <strong>GroupPolicy</strong>，如果传递<em>了 -TracePolicyStore</em>，则会在 <strong>PolicyStoreSource</strong> 字段中找到并返回 GPO 的名称。</p>
<div class="codeHeader" id="code-try-40" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Get-NetIPsecRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Require Inbound Authentication"</span><span class="hljs-parameter"> -TracePolicyStore</span>
</span></code></pre>
<p>请务必注意，公开的源不包含域名。</p>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#deploy-a-basic-domain-isolation-policy" aria-label="节标题：部署基本域隔离策略"></a><h3 id="deploy-a-basic-domain-isolation-policy" class="heading-anchor">部署基本域隔离策略</h3></div>
<p>IPsec 可用于将域成员与非域成员隔离。 域隔离使用 IPsec 身份验证要求已加入域的设备积极建立通信设备的标识，以提高组织的安全性。 IPsec 的一个或多个功能可用于使用 IPsec 规则对象保护流量。
若要在网络上实现域隔离，域中的设备会收到 IPsec 规则，以阻止不受 IPsec 保护的未经请求的入站网络流量。 在这里，我们将创建一个 IPsec 规则，该规则要求域成员进行身份验证。 通过此身份验证，可以将已加入域的设备与未加入域的设备隔离开来。 在以下示例中，入站流量需要 Kerberos 身份验证，并请求对出站流量进行身份验证。</p>
<div class="tabGroup" id="tabgroup_13" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_13_powershell" role="tab" aria-controls="tabpanel_13_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_13_cmd" role="tab" aria-controls="tabpanel_13_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_13_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-41" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-variable">$kerbprop</span> = <span class="hljs-pscommand">New-NetIPsecAuthProposal</span><span class="hljs-parameter"> -Machine</span><span class="hljs-parameter"> -Kerberos</span>
<span class="hljs-variable">$Phase1AuthSet</span> = <span class="hljs-pscommand">New-NetIPsecPhase1AuthSet</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Kerberos Auth Phase1"</span><span class="hljs-parameter"> -Proposal</span> <span class="hljs-variable">$kerbprop</span><span class="hljs-parameter"> -PolicyStore</span> domain.contoso.com\domain_isolation
<span class="hljs-pscommand">New-NetIPsecRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Basic Domain Isolation Policy"</span><span class="hljs-parameter"> -Profile</span> Domain<span class="hljs-parameter"> -Phase1AuthSet</span> <span class="hljs-variable">$Phase1AuthSet</span>.Name<span class="hljs-parameter"> -InboundSecurity</span> Require<span class="hljs-parameter"> -OutboundSecurity</span> Request<span class="hljs-parameter"> -PolicyStore</span> domain.contoso.com\domain_isolation
</span></code></pre>
</section>
<section id="tabpanel_13_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-42" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall <span class="hljs-built_in">set</span> store gpo=domain.contoso.com\domain_isolation
netsh advfirewall consec add rule name="Basic Domain Isolation Policy" profile=domain endpoint1="any" endpoint2="any" action=requireinrequestout auth1="computerkerb"
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#configure-ipsec-tunnel-mode" aria-label="节标题：配置 IPsec 隧道模式"></a><h3 id="configure-ipsec-tunnel-mode" class="heading-anchor">配置 IPsec 隧道模式</h3></div>
<p>以下命令创建一个 IPsec 隧道，该隧道通过本地设备上的接口 (192.168.0.0/16) 路由来自专用网络的流量 (1.1.1 (1.1.1) ) 通过公共接口 (2.2.2.2) 连接到另一个专用网络， (192.157.0.0/16) 连接到另一个设备的公共网络。 使用 ESP/SHA1 检查通过隧道的所有流量的完整性，并使用 ESP/DES3 对其进行加密。</p>
<div class="tabGroup" id="tabgroup_14" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_14_powershell" role="tab" aria-controls="tabpanel_14_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_14_cmd" role="tab" aria-controls="tabpanel_14_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_14_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-43" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-variable">$QMProposal</span> = <span class="hljs-pscommand">New-NetIPsecQuickModeCryptoProposal</span><span class="hljs-parameter"> -Encapsulation</span> ESP<span class="hljs-parameter"> -ESPHash</span> SHA1<span class="hljs-parameter"> -Encryption</span> DES3
<span class="hljs-variable">$QMCryptoSet</span> = <span class="hljs-pscommand">New-NetIPsecQuickModeCryptoSet</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"esp:sha1-des3"</span><span class="hljs-parameter"> -Proposal</span> <span class="hljs-variable">$QMProposal</span>
<span class="hljs-pscommand">New-NetIPSecRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Tunnel from HQ to Dallas Branch"</span><span class="hljs-parameter"> -Mode</span> Tunnel<span class="hljs-parameter"> -LocalAddress</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">0.0</span>/<span class="hljs-number">16</span><span class="hljs-parameter"> -RemoteAddress</span> <span class="hljs-number">192.157</span>.<span class="hljs-number">0.0</span>/<span class="hljs-number">16</span><span class="hljs-parameter"> -LocalTunnelEndpoint</span> <span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span><span class="hljs-parameter"> -RemoteTunnelEndpoint</span>&nbsp;<span class="hljs-number">2.2</span>.<span class="hljs-number">2.2</span><span class="hljs-parameter"> -InboundSecurity</span> Require<span class="hljs-parameter"> -OutboundSecurity</span> Require<span class="hljs-parameter"> -QuickModeCryptoSet</span> <span class="hljs-variable">$QMCryptoSet</span>.Name
</span></code></pre>
</section>
<section id="tabpanel_14_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-44" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall consec add rule name="Tunnel from <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>/<span class="hljs-number">16</span> to <span class="hljs-number">192</span>.<span class="hljs-number">157</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>/<span class="hljs-number">16</span>" <span class="hljs-built_in">mode</span>=tunnel endpoint1=<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>/<span class="hljs-number">16</span> endpoint2=<span class="hljs-number">192</span>.<span class="hljs-number">157</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>/<span class="hljs-number">16</span> localtunnelendpoint=<span class="hljs-number">1</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span> remotetunnelendpoint=<span class="hljs-number">2</span>.<span class="hljs-number">2</span>.<span class="hljs-number">2</span>.<span class="hljs-number">2</span> action=requireinrequireout qmsecmethods=esp:sha1-<span class="hljs-number">3</span>des
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h2"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#deploy-secure-firewall-rules-with-ipsec" aria-label="节标题：使用 IPsec 部署安全防火墙规则"></a><h2 id="deploy-secure-firewall-rules-with-ipsec" class="heading-anchor">使用 IPsec 部署安全防火墙规则</h2></div>
<p>在仅允许安全流量通过 Windows 防火墙的情况下，需要将手动配置的防火墙和 IPsec 规则组合在一起。 防火墙规则确定允许的数据包的安全级别，基础 IPsec 规则保护流量。 这些方案可以在 Windows PowerShell 和 Netsh 中完成，在部署方面有许多相似之处。</p>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#create-a-secure-firewall-rule-allow-if-secure" aria-label="节标题：如果安全) ， (允许创建安全防火墙规则"></a><h3 id="create-a-secure-firewall-rule-allow-if-secure" class="heading-anchor">如果安全) ， (允许创建安全防火墙规则</h3></div>
<p>配置防火墙规则以允许连接（如果连接是安全的）需要对相应的流量进行身份验证和完整性保护，然后选择性地由 IPsec 加密。
以下示例创建要求对流量进行身份验证的防火墙规则。 仅当使用单独的 IPsec 规则对来自远程设备的连接进行身份验证时，命令才允许入站 Telnet 网络流量。</p>
<div class="tabGroup" id="tabgroup_15" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_15_powershell" role="tab" aria-controls="tabpanel_15_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_15_cmd" role="tab" aria-controls="tabpanel_15_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_15_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-45" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-pscommand">New-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Allow Authenticated Telnet"</span><span class="hljs-parameter"> -Direction</span> Inbound<span class="hljs-parameter"> -Program</span> %SystemRoot%\System32\tlntsvr.exe<span class="hljs-parameter"> -Authentication</span> Required<span class="hljs-parameter"> -Action</span> Allow
</span></code></pre>
</section>
<section id="tabpanel_15_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-46" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall firewall add rule name="Allow Authenticated Telnet" <span class="hljs-built_in">dir</span>=<span class="hljs-keyword">in</span> program=<span class="hljs-variable">%SystemRoot%</span>\System32\tlntsvr.exe security=authenticate action=allow
</span></code></pre>
</section>
</div>

<p>以下命令创建一个 IPsec 规则，该规则要求第一个 (计算机) 身份验证，然后尝试第二个可选的 (用户) 身份验证。 创建此规则可保护流量，并允许流量通过信使程序的防火墙规则要求。</p>
<div class="tabGroup" id="tabgroup_16" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_16_powershell" role="tab" aria-controls="tabpanel_16_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_16_cmd" role="tab" aria-controls="tabpanel_16_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_16_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-47" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-variable">$mkerbauthprop</span> = <span class="hljs-pscommand">New-NetIPsecAuthProposal</span><span class="hljs-parameter"> -Machine</span><span class="hljs-parameter"> -Kerberos</span>
<span class="hljs-variable">$mntlmauthprop</span> = <span class="hljs-pscommand">New-NetIPsecAuthProposal</span><span class="hljs-parameter"> -Machine</span><span class="hljs-parameter"> -NTLM</span>
<span class="hljs-variable">$P1Auth</span> = <span class="hljs-pscommand">New-NetIPsecPhase1AuthSet</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Machine Auth"</span><span class="hljs-parameter"> -Proposal</span> <span class="hljs-variable">$mkerbauthprop</span>,<span class="hljs-variable">$mntlmauthprop</span>
<span class="hljs-variable">$ukerbauthprop</span> = <span class="hljs-pscommand">New-NetIPsecAuthProposal</span><span class="hljs-parameter"> -User</span><span class="hljs-parameter"> -Kerberos</span>
<span class="hljs-variable">$unentlmauthprop</span> = <span class="hljs-pscommand">New-NetIPsecAuthProposal</span><span class="hljs-parameter"> -User</span><span class="hljs-parameter"> -NTLM</span>
<span class="hljs-variable">$anonyauthprop</span> = <span class="hljs-pscommand">New-NetIPsecAuthProposal</span><span class="hljs-parameter"> -Anonymous</span>
<span class="hljs-variable">$P2Auth</span> = <span class="hljs-pscommand">New-NetIPsecPhase2AuthSet</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"User Auth"</span><span class="hljs-parameter"> -Proposal</span> <span class="hljs-variable">$ukerbauthprop</span>,<span class="hljs-variable">$unentlmauthprop</span>,<span class="hljs-variable">$anonyauthprop</span>
<span class="hljs-pscommand">New-NetIPSecRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Authenticate Both Computer and User"</span><span class="hljs-parameter"> -InboundSecurity</span> Require<span class="hljs-parameter"> -OutboundSecurity</span> Require<span class="hljs-parameter"> -Phase1AuthSet</span> <span class="hljs-variable">$P1Auth</span>.Name<span class="hljs-parameter"> -Phase2AuthSet</span> <span class="hljs-variable">$P2Auth</span>.Name
</span></code></pre>
</section>
<section id="tabpanel_16_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-48" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall consec add rule name="Authenticate Both Computer and User" endpoint1=any endpoint2=any action=requireinrequireout auth1=computerkerb,computerntlm auth2=userkerb,userntlm,anonymous
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#isolate-a-server-by-requiring-encryption-and-group-membership" aria-label="节标题：通过要求加密和组成员身份来隔离服务器"></a><h3 id="isolate-a-server-by-requiring-encryption-and-group-membership" class="heading-anchor">通过要求加密和组成员身份来隔离服务器</h3></div>
<p>若要提高组织中设备的安全性，可以部署限制域成员的域隔离。 它们要求在相互通信时进行身份验证，并拒绝未经身份验证的入站连接。 若要提高具有敏感数据的服务器的安全性，必须通过仅允许访问企业域中的一部分设备来保护此数据。
IPsec 可以通过隔离服务器来提供此额外的保护层。 在服务器隔离中，敏感数据访问仅限于具有合法业务需求的用户和设备，并且数据会额外加密以防止窃听。</p>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#create-a-firewall-rule-that-requires-group-membership-and-encryption" aria-label="节标题：创建需要组成员身份和加密的防火墙规则"></a><h3 id="create-a-firewall-rule-that-requires-group-membership-and-encryption" class="heading-anchor">创建需要组成员身份和加密的防火墙规则</h3></div>
<p>为了部署服务器隔离，我们分层了一个防火墙规则，该规则将流量限制到强制身份验证的 IPsec 规则上的授权用户或设备。
以下防火墙规则允许来自名为“已授权访问服务器”的自定义组成员的用户帐户的 Telnet 流量。此外，还可以通过指定限制参数，根据设备、用户或两者来限制此访问。
通过将用户或组的安全标识符扩展 (SID) 来创建安全描述符定义语言 (SDDL) 字符串。 有关查找组的 SID 的详细信息，请参阅： <a href="https://learn.microsoft.com/zh-cn/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753463(v=ws.10)#bkmk_FINDSID" data-linktype="absolute-path">查找组帐户的 SID</a>。
通过限制对组的访问，管理部门可以通过 Windows 防火墙和/或 IPsec 策略扩展强身份验证支持。
以下示例演示如何创建表示安全组的 SDDL 字符串。</p>
<div class="codeHeader" id="code-try-49" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-variable">$user</span> = <span class="hljs-pscommand">new-object</span> System.Security.Principal.NTAccount (<span class="hljs-string">"corp.contoso.com\Administrators"</span>)
<span class="hljs-variable">$SIDofSecureUserGroup</span> = <span class="hljs-variable">$user</span>.Translate([System.Security.Principal.SecurityIdentifier]).Value
<span class="hljs-variable">$secureUserGroup</span> = <span class="hljs-string">"D:(A;;CC;;;<span class="hljs-variable">$SIDofSecureUserGroup</span>)"</span>
</span></code></pre>
<p>通过使用前面的 scriptlet，还可以获取安全计算机组的 SDDL 字符串，如下所示：</p>
<div class="codeHeader" id="code-try-50" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-variable">$secureMachineGroup</span> = <span class="hljs-string">"D:(A;;CC;;;<span class="hljs-variable">$SIDofSecureMachineGroup</span>)"</span>
</span></code></pre>
<p>有关如何创建安全组或如何确定 SDDL 字符串的详细信息，请参阅 <a href="https://learn.microsoft.com/zh-cn/previous-versions/windows/it-pro/windows-powershell-1.0/ff730940(v=technet.10)" data-linktype="absolute-path">使用 SID</a>。
Telnet 是一个不提供加密的应用程序。 此应用程序可以通过网络发送数据，例如名称和密码。 恶意用户可能会截获此数据。 如果管理员希望允许使用 Telnet，但要保护流量，则可以创建需要 IPsec 加密的防火墙规则。 此防火墙规则是必需的，以便管理员能够确保使用此应用程序时，此端口发送或接收的所有流量都已加密。 如果 IPsec 未能授权连接，则不允许来自此应用程序的流量。
在此示例中，通过创建以下防火墙规则，仅允许来自指定安全用户组的经过身份验证和加密的入站 Telnet 流量。</p>
<div class="tabGroup" id="tabgroup_17" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_17_powershell" role="tab" aria-controls="tabpanel_17_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_17_cmd" role="tab" aria-controls="tabpanel_17_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_17_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-51" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-pscommand">New-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Allow Encrypted Inbound Telnet to Group Members Only"</span><span class="hljs-parameter"> -Program</span> %SystemRoot%\System32\tlntsvr.exe<span class="hljs-parameter"> -Protocol</span> TCP<span class="hljs-parameter"> -Direction</span> Inbound<span class="hljs-parameter"> -Action</span> Allow<span class="hljs-parameter"> -LocalPort</span>&nbsp;<span class="hljs-number">23</span><span class="hljs-parameter"> -Authentication</span> Required<span class="hljs-parameter"> -Encryption</span> Required<span class="hljs-parameter"> -RemoteUser</span> <span class="hljs-variable">$secureUserGroup</span><span class="hljs-parameter"> -PolicyStore</span> domain.contoso.com\Server_Isolation
</span></code></pre>
</section>
<section id="tabpanel_17_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-52" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall <span class="hljs-built_in">set</span> store gpo=domain.contoso.com\Server_Isolation
netsh advfirewall firewall add rule name="Allow Encrypted Inbound Telnet to Group Members Only" program=<span class="hljs-variable">%SystemRoot%</span>\System32\tlntsvr.exe protocol=TCP <span class="hljs-built_in">dir</span>=<span class="hljs-keyword">in</span> action=allow localport=<span class="hljs-number">23</span> security=authenc rmtusrgrp ="D:(A;;CC;;; S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">2329867823</span>-<span class="hljs-number">2610410949</span>-<span class="hljs-number">1491576313</span>-<span class="hljs-number">1735</span>)"
</span></code></pre>
</section>
</div>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#endpoint-security-enforcement" aria-label="节标题：终结点安全强制实施"></a><h3 id="endpoint-security-enforcement" class="heading-anchor">终结点安全强制实施</h3></div>
<p>上一个示例演示了特定应用程序的端到端安全性。 如果许多应用程序需要终结点安全性，则每个应用程序都有防火墙规则可能很麻烦且难以管理。 授权可以重写每个规则的基础，并在 IPsec 层完成。
在此示例中，我们将全局 IPsec 设置设置为仅允许传输模式流量来自具有以下 cmdlet 的授权用户组。 请参阅前面的示例以使用安全组。</p>
<div class="codeHeader" id="code-try-53" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-powershell"><span><span class="hljs-pscommand">Set-NetFirewallSetting</span><span class="hljs-parameter"> -RemoteMachineTransportAuthorizationList</span> <span class="hljs-variable">$secureMachineGroup</span>
</span></code></pre>
<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#create-firewall-rules-that-allow-ipsec-protected-network-traffic-authenticated-bypass" aria-label="节标题：创建防火墙规则，允许受 IPsec 保护的网络流量 (经过身份验证的旁路)"></a><h3 id="create-firewall-rules-that-allow-ipsec-protected-network-traffic-authenticated-bypass" class="heading-anchor">创建防火墙规则，允许受 IPsec 保护的网络流量 (经过身份验证的旁路) </h3></div>
<p>经过身份验证的旁路允许来自指定受信任设备或用户的流量替代防火墙阻止规则。 当管理员想要使用扫描服务器来监视和更新设备而无需使用端口级异常时，此替代非常有用。 有关详细信息，请参阅 <a href="https://learn.microsoft.com/zh-cn/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753463(v=ws.10)" data-linktype="absolute-path">如何启用经过身份验证的防火墙绕过</a>。
在此示例中，假定存在阻止防火墙规则。 此示例允许来自任何 IP 地址的任何端口上的任何网络流量覆盖阻止规则（如果流量被验证为源自指定设备或用户安全组的成员的设备或用户帐户）。</p>
<div class="tabGroup" id="tabgroup_18" data-bi-name="tab-group">
<ul role="tablist">
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_18_powershell" role="tab" aria-controls="tabpanel_18_powershell" data-tab="powershell" tabindex="0" aria-selected="true" data-linktype="self-bookmark" data-bi-name="tab"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/powershell.svg" role="presentation" data-linktype="relative-path"><strong>PowerShell</strong></a>
</li>
<li role="presentation">
<a href="https://learn.microsoft.com/zh-cn/windows/security/operating-system-security/network-security/windows-firewall/configure-with-command-line?tabs=powershell#tabpanel_18_cmd" role="tab" aria-controls="tabpanel_18_cmd" data-tab="cmd" tabindex="-1" data-linktype="self-bookmark" data-bi-name="tab" aria-selected="false"><img src="./使用命令行管理 Windows 防火墙 - Windows Security _ Microsoft Learn_files/cmd.svg" role="presentation" data-linktype="relative-path"><strong>命令提示符</strong></a>
</li>
</ul>
<section id="tabpanel_18_powershell" role="tabpanel" data-tab="powershell">

<div class="codeHeader" id="code-try-54" data-bi-name="code-header"><span class="language">PowerShell</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus" role="group" aria-label="可水平滚动的代码" tabindex="0"><code class="lang-powershell"><span><span class="hljs-pscommand">New-NetFirewallRule</span><span class="hljs-parameter"> -DisplayName</span> <span class="hljs-string">"Inbound Secure Bypass Rule"</span><span class="hljs-parameter"> -Direction</span> Inbound<span class="hljs-parameter"> -Authentication</span> Required<span class="hljs-parameter"> -OverrideBlockRules</span> <span class="hljs-literal">$true</span><span class="hljs-parameter"> -RemoteMachine</span> <span class="hljs-variable">$secureMachineGroup</span><span class="hljs-parameter"> -RemoteUser</span> <span class="hljs-variable">$secureUserGroup</span><span class="hljs-parameter"> -PolicyStore</span> domain.contoso.com\domain_isolation
</span></code></pre>
</section>
<section id="tabpanel_18_cmd" role="tabpanel" data-tab="cmd" hidden="hidden" aria-hidden="true">

<div class="codeHeader" id="code-try-55" data-bi-name="code-header"><span class="language">Windows 命令提示符</span>
		<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
			<span>复制</span>
			<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
			</div>
		</button>
	</div><pre class="has-inner-focus"><code class="lang-cmd"><span>netsh advfirewall <span class="hljs-built_in">set</span> store gpo=domain.contoso.com\domain_isolation
netsh advfirewall firewall add rule name="Inbound Secure Bypass Rule" <span class="hljs-built_in">dir</span>=<span class="hljs-keyword">in</span> security=authenticate action="bypass" rmtcomputergrp="D:(A;;CC;;;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">2329867823</span>-<span class="hljs-number">2610410949</span>-<span class="hljs-number">1491576313</span>-<span class="hljs-number">1114</span>)" rmtusrgrp="D:(A;;CC;;; S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">2329867823</span>-<span class="hljs-number">2610410949</span>-<span class="hljs-number">1491576313</span>-<span class="hljs-number">1735</span>)"
</span></code></pre>
</section>
</div>
</div><div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div><div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<!-- </content> -->

						</main><!-- recommendations section --><!-- end recommendations section -->

						<!-- feedback section --><section id="site-user-feedback-footer" class="font-size-sm margin-top-md" data-test-id="site-user-feedback-footer" data-bi-name="site-feedback-section">
	<hr class="hr">
	<h2 id="feedback" class="title is-3">反馈</h2>
	<div class="display-flex flex-wrap-wrap align-items-center">
		<p class="font-weight-semibold margin-xxs margin-left-none">此页面是否有帮助？</p>
		<div class="buttons">
			<button class="thumb-rating-button like button button-primary button-sm" data-test-id="footer-rating-yes" data-binary-rating-response="rating-yes" type="button" title="本文非常有用" data-bi-name="button-rating-yes" aria-pressed="false">
				<span class="icon" aria-hidden="true">
					<span class="docon docon-like"></span>
				</span>
				<span>是</span>
			</button>
			<button class="thumb-rating-button dislike button button-primary button-sm" data-test-id="footer-rating-no" data-binary-rating-response="rating-no" type="button" title="本文没有用" data-bi-name="button-rating-no" aria-pressed="false">
				<span class="icon" aria-hidden="true">
					<span class="docon docon-dislike"></span>
				</span>
				<span>否</span>
			</button>
		</div>
	</div><div class="display-flex flex-wrap-wrap margin-top-xxs"><div>
			<a data-bi-name="provide-feedback-cta" class="has-external-link-indicator" href="https://support.microsoft.com/windows/send-feedback-to-microsoft-with-the-feedback-hub-app-f59187f8-8739-22d6-ba93-f66612949332">
				<span>提供产品反馈</span>
			</a></div></div>

</section><section class="feedback-section position-relative" data-bi-name="feedback-section" hidden="">
    <h2 class="title is-3 margin-top-sm">反馈</h2>

    <div class="alert choose-feedback-type padding-bottom-sm">
		<p id="git-issues-deprecation-notice">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-status-info-outline">
			</span>
			</span>即将发布：在整个 2024 年，我们将逐步淘汰作为内容反馈机制的“GitHub 问题”，并将其取代为新的反馈系统。 有关详细信息，请参阅：<a href="https://aka.ms/ContentUserFeedback" data-bi-name="content-user-feedback">https://aka.ms/ContentUserFeedback</a>。</p>

        <p id="send-feedback-about" class="margin-top-sm">提交和查看相关反馈</p>

        <div class="choose-feedback-buttons buttons margin-top-xs"><a class="button has-external-link-indicator feedback-type-product" aria-label="发送有关此产品的反馈" href="https://support.microsoft.com/windows/send-feedback-to-microsoft-with-the-feedback-hub-app-f59187f8-8739-22d6-ba93-f66612949332" data-bi-name="product-feedback">
                    <span>此产品</span>
                </a><a class="button feedback-type-product github-link" aria-label="发送有关此页面的反馈" data-bi-name="create-issue-on-github" href="https://github.com//issues/new?title=&amp;body=%0A%0A%5B%E5%9C%A8%E6%AD%A4%E5%A4%84%E8%BE%93%E5%85%A5%E5%8F%8D%E9%A6%88%5D%0A%0A%0A---%0A%23%23%23%23%20%E6%96%87%E6%A1%A3%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF%0A%0A%E2%9A%A0%20*%E8%AF%B7%E5%8B%BF%E7%BC%96%E8%BE%91%E6%AD%A4%E9%83%A8%E5%88%86%E3%80%82%20learn.microsoft.com%20%E2%9E%9F%20GitHub%20%E9%97%AE%E9%A2%98%E9%93%BE%E6%8E%A5%E5%BF%85%E9%A1%BB%E5%85%B7%E6%9C%89%E6%AD%A4%E9%83%A8%E5%88%86%E3%80%82*%0A%0A*%20ID%3A%20c5db536a-6143-8c09-b308-bd07fca3dec4%0A*%20Version%20Independent%20ID%3A%20c5db536a-6143-8c09-b308-bd07fca3dec4%0A*%20Content%3A%20%5B%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%A1%E7%90%86%20Windows%20%E9%98%B2%E7%81%AB%E5%A2%99%20-%20Windows%20Security%5D(https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line%3Ftabs%3Dpowershell)%0A*%20Content%20Source%3A%20%5Bwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line.md%5D(https%3A%2F%2Fgithub.com%2FMicrosoftDocs%2Fwindows-itpro-docs%2Fblob%2Fpublic%2Fwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line.md)%0A*%20Service%3A%20**windows-client**%0A*%20Sub-service%3A%20**itpro-security**%0A*%20GitHub%20Login%3A%20%40paolomatarazzo%0A*%20Microsoft%20Alias%3A%20**paoloma**">
				<span class="icon" aria-hidden="true">
					<span class="docon docon-brand-github"></span>
				</span>
				<span>此页面</span>
			</a>
        </div>
    </div>

    <div class="action-container display-flex justify-content-flex-end margin-block-xxs">
        <a class="view-on-github has-external-link-indicator" data-bi-name="view-on-github" href="https://github.com//issues?utf8=%E2%9C%93&amp;q=%22c5db536a-6143-8c09-b308-bd07fca3dec4%22&amp;in=body">
            <span aria-hidden="true" class="docon docon-brand-github"></span>
            <span>查看所有页面反馈</span>
        </a>
    </div>
</section><!-- end feedback section -->

						<!-- feedback report section --><!-- end feedback report section --><aside id="ms--additional-resources-mobile" aria-label="其他资源" class="display-none-desktop display-none-print">
								<hr class="hr">
								<h2 id="ms--additional-resources-mobile-heading" class="title is-3">其他资源</h2>
								<section id="right-rail-recommendations-mobile" data-bi-name="recommendations" hidden=""></section>
								<section id="right-rail-training-mobile" data-bi-name="learning-resources-card"><!---->
		<hr class="hr display-none display-block-desktop">
		<article class="margin-top-md margin-top-sm-desktop">
			
		<p class="font-weight-semibold font-size-md display-flex align-items-center">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-cube-cone-ball-shapes"></span>
			</span>
			培训
		</p>
	
			<div class="margin-top-xs position-relative">
				<!---->
		<div class="position-relative margin-top-xs">
			 
				<p class="has-line-height-reset color-text-subtle font-size-xs font-weight-semibold">
					模块
				</p>
		   
				<p class="line-clamp-3">
					<a class="display-block inner-focus font-weight-semibold font-size-sm has-line-height-reset stretched-link" href="https://learn.microsoft.com/zh-cn/training/modules/manage-network-service-settings-for-windows-devices-use-powershell-cmdlets/?source=recommendations">
						使用 PowerShell cmdlet 管理 Windows 设备的网络服务设置 - Training
					</a>
				</p>
		   
			
		<p class="font-size-sm has-line-height-reset color-text-subtle margin-top-xxs line-clamp-3">
			本模块介绍用于为 Windows 设备配置网络设置的 PowerShell 模块和 cmdlet。
		</p>
	
		</div>
	<!----><!---->
			</div>
			
		</article>
	<!----></section>
								<section id="right-rail-events-mobile" data-bi-name="events-card" hidden=""></section>
								<section id="right-rail-qna-mobile" data-bi-name="qna-link-card" hidden=""></section>
							</aside><div class="border-top is-visible-interactive has-default-focus margin-top-sm "><footer id="footer-interactive" data-bi-name="footer" class="footer-layout"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a data-mscc-ic="false" class="locale-selector-link button button-sm button-clear flex-shrink-0" href="https://learn.microsoft.com/zh-cn/locale?target=https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line" data-bi-name="select-locale" aria-label="内容语言选择器。 当前设置为 中文 (简体)。">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text">中文 (简体)</span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link="">
<a href="https://aka.ms/yourcaliforniaprivacychoices" class="button button-sm button-clear flex-shrink-0" data-mscc-ic="false" data-bi-name="your-privacy-choices">
	<svg role="img" aria-label="加州消费者隐私法案 (CCPA) 禁用图标" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 14" xml:space="preserve" height="16" width="43" focusable="false">
		<title>加州消费者隐私法案 (CCPA) 禁用图标</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>你的隐私选择</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu-interactive" aria-expanded="false" title="主题" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>主题</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="light" aria-pressed="false">
					<span class="theme-light margin-right-xxs">
						<span class="theme-selector-icon border display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>亮</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start is-selected" data-theme-to="dark" aria-pressed="true">
					<span class="theme-dark margin-right-xxs">
						<span class="border theme-selector-icon display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>暗</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast margin-right-xxs">
						<span class="border theme-selector-icon display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>高对比度</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder"><button data-bi-name="manageCookies">管理 Cookie</button></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/zh-cn/previous-versions/" data-bi-name="archivelink">早期版本</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">博客</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/zh-cn/contribute/" data-bi-name="contributorGuide">参与</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">隐私</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/zh-cn/legal/termsofuse" data-bi-name="termsofuse">使用条款</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">商标</a></li><li>© Microsoft 2024</li>
	</ul>
</footer></div></div><div id="ms--additional-resources" class="right-container column is-4-desktop display-none display-block-desktop" data-bi-name="pageactions" role="complementary" aria-label="其他资源">
							<div id="affixed-right-container" class="margin-top-sm-tablet position-sticky" data-bi-name="right-column" style="top: 36px; bottom: 36px;">
								<h2 id="ms--additional-resources-heading" class="title is-6 margin-top-md">其他资源</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden=""></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card"><!---->
		<hr class="hr display-none display-block-desktop">
		<article class="margin-top-md margin-top-sm-desktop">
			
		<p class="font-weight-semibold font-size-md display-flex align-items-center">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-cube-cone-ball-shapes"></span>
			</span>
			培训
		</p>
	
			<div class="margin-top-xs position-relative">
				<!---->
		<div class="position-relative margin-top-xs">
			 
				<p class="has-line-height-reset color-text-subtle font-size-xs font-weight-semibold">
					模块
				</p>
		   
				<p class="line-clamp-3">
					<a class="display-block inner-focus font-weight-semibold font-size-sm has-line-height-reset stretched-link" href="https://learn.microsoft.com/zh-cn/training/modules/manage-network-service-settings-for-windows-devices-use-powershell-cmdlets/?source=recommendations">
						使用 PowerShell cmdlet 管理 Windows 设备的网络服务设置 - Training
					</a>
				</p>
		   
			
		<p class="font-size-sm has-line-height-reset color-text-subtle margin-top-xxs line-clamp-3">
			本模块介绍用于为 Windows 设备配置网络设置的 PowerShell 模块和 cmdlet。
		</p>
	
		</div>
	<!----><!---->
			</div>
			
		</article>
	<!----></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden=""></section>
								<nav id="side-doc-outline" class="doc-outline" data-bi-name="intopic toc" aria-label="本文内容">
									<h3>本文内容</h3>
								</nav>
								<section id="right-rail-qna" class="margin-top-xxs" data-bi-name="qna-link-card" hidden=""></section>
							</div>
						</div></div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm "><footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a data-mscc-ic="false" class="locale-selector-link button button-sm button-clear flex-shrink-0" href="https://learn.microsoft.com/zh-cn/locale?target=https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fwindows%2Fsecurity%2Foperating-system-security%2Fnetwork-security%2Fwindows-firewall%2Fconfigure-with-command-line" data-bi-name="select-locale" aria-label="内容语言选择器。 当前设置为 中文 (简体)。">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text">中文 (简体)</span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link="">
<a href="https://aka.ms/yourcaliforniaprivacychoices" class="button button-sm button-clear flex-shrink-0" data-mscc-ic="false" data-bi-name="your-privacy-choices">
	<svg role="img" aria-label="加州消费者隐私法案 (CCPA) 禁用图标" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 14" xml:space="preserve" height="16" width="43" focusable="false">
		<title>加州消费者隐私法案 (CCPA) 禁用图标</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>你的隐私选择</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu" aria-expanded="false" title="主题" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>主题</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="light" aria-pressed="false">
					<span class="theme-light margin-right-xxs">
						<span class="theme-selector-icon border display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>亮</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start is-selected" data-theme-to="dark" aria-pressed="true">
					<span class="theme-dark margin-right-xxs">
						<span class="border theme-selector-icon display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>暗</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast margin-right-xxs">
						<span class="border theme-selector-icon display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>高对比度</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder"><button data-bi-name="manageCookies">管理 Cookie</button></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/zh-cn/previous-versions/" data-bi-name="archivelink">早期版本</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">博客</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/zh-cn/contribute/" data-bi-name="contributorGuide">参与</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">隐私</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/zh-cn/legal/termsofuse" data-bi-name="termsofuse">使用条款</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">商标</a></li><li>© Microsoft 2024</li>
	</ul>
</footer>

	</section><div id="action-panel" role="region" aria-label="操作面板" class="action-panel has-default-focus" tabindex="-1"></div>

</body></html>